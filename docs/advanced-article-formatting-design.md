# å»£ç·¨ç¨¿/æ–°èç¨¿é€²éšæ ¼å¼åŒ–åŠŸèƒ½è¨­è¨ˆæ–¹æ¡ˆ

## ğŸ“‹ éœ€æ±‚å¯¦ç¾é€²åº¦è¿½è¹¤

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½éœ€æ±‚ Checklist

#### 1. æ–‡ç¨¿åˆ†é¡èˆ‡æŠ¼è¨»ç³»çµ±
- [x] **å»£ç·¨ç¨¿æŠ¼è¨»** - æ­£æ–‡å‰æ–¹æŠ¼è¨»æ¨¡æ¿
- [x] **å»£ç·¨ç¨¿å…è²¬è²æ˜** - æ­£æ–‡æ–‡æœ«æŠ¼è¨»æ¨¡æ¿  
- [x] **æ–°èç¨¿æŠ¼è¨»** - åƒ…æ­£æ–‡å‰æ–¹æŠ¼è¨»ï¼ˆç„¡æ–‡æœ«è²æ˜ï¼‰
- [x] **ä½œè€…è¨­å®šé‚è¼¯** - å»£ç·¨ç¨¿ï¼šã€Œå»£ç·¨é »é“ï¼ˆBTEditorï¼‰ã€/ æ–°èç¨¿ï¼šã€ŒBTå®™åŸŸï¼ˆBTVerseï¼‰ã€
- [ ] **æŠ¼è¨»å…§å®¹è‡ªå‹•æ›¿æ›** - å‹•æ…‹æ›¿æ›æ’°ç¨¿æ–¹åç¨±
- [ ] **æ¨¡æ¿è‡ªå‹•æ‡‰ç”¨** - æ ¹æ“šæ–‡ç¨¿é¡å‹è‡ªå‹•å¥—ç”¨å°æ‡‰æ¨¡æ¿

#### 2. æ­£æ–‡æ ¼å¼è™•ç†
- [x] **ç™¼å¸ƒæ™‚é–“è§£ç¦æ•˜è¿°éæ¿¾** - ç§»é™¤ "EMBARGOED TILL" ç­‰æ•˜è¿°ï¼ˆâœ… å·²æ­¸å±¬AIéšæ®µè™•ç†ï¼‰
- [x] **Dropcap æ ¼å¼æ‡‰ç”¨** - ç¬¬ä¸€æ®µé–‹é ­ç¬¬ä¸€å€‹å­—è‡ªå‹•è¨­ç‚º Dropcap
- [x] **è‹±æ–‡æ•¸å­—ç©ºæ ¼è™•ç†** - è‹±æ–‡å’Œæ•¸å­—å‰å¾Œç©ºåŠæ ¼ï¼ˆæ®µé¦–é™¤å¤–ï¼‰ï¼ˆâœ… å·²æ­¸å±¬AIéšæ®µè™•ç†ï¼‰
- [x] **æ¨™é¡Œå±¤ç´šæ­£è¦åŒ–** - æ®µè½æ¨™é¡Œå„ªå…ˆè¨­ç‚ºã€Œæ¨™é¡Œä¸‰ã€ï¼Œå±¤ç´šï¼šæ¨™é¡Œä¸‰ > æ¨™é¡Œå›› > æ®µè½ï¼ˆç²—é«”ï¼‰âœ… å·²ä¿®å¾©é€£é–æ›¿æ›å•é¡Œ

#### 3. å¼•è¨€èˆ‡é—œè¯æ–‡ç« ç³»çµ±
- [x] **å¼•è¨€è‡ªå‹•ç”Ÿæˆ** - æœ‰å‰¯æ¨™é¡Œç›´æ¥ä½¿ç”¨ï¼Œç„¡å‰¯æ¨™é¡Œç”¨ AI æ‘˜è¦ï¼ˆâ‰¤100å­—ï¼‰âœ… å·²ä¿®å¾©æ•¸æ“šå‚³éå•é¡Œ
- [x] **å¼•è¨€æ ¼å¼å¥—ç”¨** - ä½¿ç”¨ `intro_quote` class æ ¼å¼
- [ ] **å‰æƒ…æè¦æ–‡ç« æœå°‹** - å¾ BlockTempo æœå°‹ç›¸é—œæ–‡ç« 
- [ ] **èƒŒæ™¯è£œå……æ–‡ç« æœå°‹** - å¾ BlockTempo æœå°‹ç›¸é—œæ–‡ç« 
- [x] **å¼•è¨€å€å¡ŠHTMLç”Ÿæˆ** - è‡ªå‹•ç”ŸæˆåŒ…å«å‰æƒ…æè¦å’ŒèƒŒæ™¯è£œå……çš„å®Œæ•´HTMLï¼ˆä½¿ç”¨é è¨­æ¨¡æ¿ï¼‰
- [x] **æ–‡æœ«ç›¸é—œé–±è®€** - è‡ªå‹•æ·»åŠ 2-4ç¯‡ç›¸é—œæ–‡ç« é€£çµï¼ˆç²—é«”æ ¼å¼ï¼Œä½¿ç”¨é è¨­æ¨¡æ¿ï¼‰
- [x] **TG Bannerè‡ªå‹•æ’å…¥** - åœ¨ç›¸é—œé–±è®€å‰æ’å…¥å®˜æ–¹TGæ©«å¹…

#### 4. æ–‡æœ«é€£çµè™•ç†
- [x] **é€£çµæ•¸é‡é™åˆ¶** - æœ€å¤š3å€‹é€£çµï¼ˆâœ… å·²æ­¸å±¬AIéšæ®µè™•ç†ï¼‰
- [x] **TG/LINEé€£çµéæ¿¾** - è‡ªå‹•åˆªé™¤ Telegramã€LINE ç¤¾ç¾¤é€£çµï¼ˆâœ… å·²æ­¸å±¬AIéšæ®µè™•ç†ï¼‰
- [x] **é€£çµå„ªå…ˆç´šæ’åº** - é¸æ“‡æ’é™¤TG/LINEå¾Œçš„å‰ä¸‰å€‹é€£çµï¼ˆâœ… å·²æ­¸å±¬AIéšæ®µè™•ç†ï¼‰
- [x] **é€£çµæ ¼å¼æ¨™æº–åŒ–** - ç¢ºä¿é€£çµæ ¼å¼ç¬¦åˆè¦æ±‚


#### 6. WordPress ç™¼å¸ƒåƒæ•¸
- [ ] **ä½œè€…IDè¨­å®š** - æ ¹æ“šæ–‡ç¨¿é¡å‹è‡ªå‹•è¨­å®šå°æ‡‰ä½œè€…

### ğŸ—ï¸ æŠ€è¡“æ¶æ§‹å¯¦ç¾é€²åº¦

#### éšæ®µ1ï¼šåŸºç¤æ¶æ§‹ï¼ˆå·²å®Œæˆ âœ…ï¼‰
- [x] åœ¨uploadç•Œé¢å¢åŠ æ–‡ç¨¿é¡å‹é¸æ“‡
- [x] å»ºç«‹ArticleClassificationè³‡æ–™çµæ§‹  
- [x] å‰µå»ºåŸºç¤æ¨¡æ¿è¨­å®šæª”
- [x] ä¿®æ”¹ProcessingStateæ”¯æ´æ–°æ¬„ä½

#### éšæ®µ2ï¼šAIåˆ†æå¼·åŒ–ï¼ˆå·²å®Œæˆ âœ…ï¼‰
- [x] å¯¦ç¾é—œè¯æ–‡ç« æœå°‹åŠŸèƒ½ (ä½¿ç”¨é è¨­æ¨¡æ¿)
- [x] åŠ å¼·ä¸­æ–‡ç”¨èªè½‰æ›é‚è¼¯ (æ­¸å±¬AIéšæ®µ)
- [x] å¯¦ç¾æ’°ç¨¿æ–¹åç¨±è­˜åˆ¥ (æ­¸å±¬AIéšæ®µ)
- [x] å„ªåŒ–æ°¸ä¹…é€£çµè‹±æ–‡ç¿»è­¯ (æ­¸å±¬AIéšæ®µ)

#### éšæ®µ3ï¼šæ ¼å¼åŒ–è™•ç†å™¨ï¼ˆå·²å®Œæˆ âœ…ï¼‰
- [x] å»ºç«‹ArticleFormattingProcessoré¡
- [x] å¯¦ç¾æ¨¡æ¿åŒ–æŠ¼è¨»æ’å…¥
- [x] å¯¦ç¾Dropcapè‡ªå‹•æ‡‰ç”¨
- [x] å¯¦ç¾é—œè¯æ–‡ç« å€å¡Šæ’å…¥
- [x] å¯¦ç¾å…±ç”¨æ¨¡æ¿çµ±ä¸€ç®¡ç†
- [x] å®Œæˆæ¶æ§‹æ¸…ç†å’Œè·è²¬åˆ†é›¢

#### éšæ®µ4ï¼šåœ–ç‰‡è™•ç†å¼·åŒ–ï¼ˆå·²æ­¸å±¬AIéšæ®µ âœ…ï¼‰
- [x] å¯¦ç¾å»£ç·¨ç¨¿ADæ¨¡æ¿æ‡‰ç”¨ (æ­¸å±¬AIéšæ®µ)
- [x] åœ–ç‰‡å°ºå¯¸æª¢æŸ¥å’Œå£“ç¸®å»ºè­° (æ­¸å±¬AIéšæ®µ)
- [x] ç‰¹è‰²åœ–ç‰‡æ¨¡æ¿è™•ç† (æ­¸å±¬AIéšæ®µ)
- [x] åœ–ç‰‡altæ–‡å­—å„ªåŒ– (æ­¸å±¬AIéšæ®µ)

#### éšæ®µ5ï¼šUIå„ªåŒ–èˆ‡æ¸¬è©¦ï¼ˆé€²è¡Œä¸­ ğŸ”„ï¼‰
- [x] æ ¼å¼é è¦½ç•Œé¢é–‹ç™¼
- [x] éŒ¯èª¤è™•ç†å’Œé™ç´šç­–ç•¥
- [x] å…¨æµç¨‹æ•´åˆæ¸¬è©¦
- [ ] ä½¿ç”¨è€…é«”é©—å„ªåŒ–

#### éšæ®µ6ï¼šæ¶æ§‹å„ªåŒ–ï¼ˆå·²å®Œæˆ âœ…ï¼‰
- [x] å¯¦ç¾å…±ç”¨æ¨¡æ¿çµ±ä¸€ç®¡ç† (CommonTemplates)
- [x] ç§»é™¤é‡è¤‡æ¨¡æ¿å®šç¾© (DRYåŸå‰‡)
- [x] æ¸…ç†AIéšæ®µé…ç½®é … (è·è²¬åˆ†é›¢)
- [x] å„ªåŒ–æ¨¡æ¿ç¹¼æ‰¿å’Œè¦†è“‹æ©Ÿåˆ¶

### å®Œæˆåº¦çµ±è¨ˆ
- **ç¸½é«”é€²åº¦**: 42% (11/26 ä¸»è¦ä»»å‹™) â†’ **48%** (12/25 ä¸»è¦ä»»å‹™ï¼Œç§»é™¤1å€‹ç„¡ç”¨ä»»å‹™) â†’ **52%** (13/25 ä¸»è¦ä»»å‹™) â†’ **56%** (14/25 ä¸»è¦ä»»å‹™) â†’ **60%** (15/25 ä¸»è¦ä»»å‹™) â†’ **64%** (16/25 ä¸»è¦ä»»å‹™)
- **åŸºç¤æ¶æ§‹**: 100% âœ… 
- **æ ¸å¿ƒåŠŸèƒ½**: 64% ğŸ”„ (16/25å€‹åŠŸèƒ½é …ç›®å·²å®Œæˆ)
- **æŠ€è¡“é›†æˆ**: 95% ğŸ”„ (æ–°å¢æ™ºèƒ½å­—ç¬¦è™•ç†æ”¹é€²)
- **æ¶æ§‹å„ªåŒ–**: 95% âœ… (æ–°å¢ï¼šè·è²¬åˆ†é›¢å’Œé…ç½®æ¸…ç†)
- **éŒ¯èª¤ä¿®å¾©**: 100% âœ… (æ–°å¢ï¼šUnicodeç·¨ç¢¼ã€Dropcapå®šä½ã€æ¨¡æ¿é‡è¤‡å®šç¾©ã€AIæ‘˜è¦æ•¸æ“šå‚³éã€ç«¶æ…‹æ¢ä»¶ã€Dropcapæ™ºèƒ½å­—ç¬¦è™•ç†ç­‰å•é¡Œ)

---

## 1. ç¾æœ‰æ¶æ§‹åˆ†æ

### 1.1 ç¾æœ‰ç³»çµ±æ¶æ§‹å›é¡§
æ ¹æ“š `auto-params-design.md` æ–‡æª”ï¼Œç›®å‰ç³»çµ±æ¡ç”¨éšæ®µæ€§æµæ°´ç·šè™•ç†ï¼š
- **åˆæ­¥è™•ç†éšæ®µ**ï¼šupload â†’ extract â†’ process
- **å¾ŒæœŸè™•ç†éšæ®µ**ï¼šadvanced-ai â†’ format-conversion â†’ copy-editing
- **ä¸Šç¨¿éšæ®µ**ï¼šprep-publish â†’ publish-news

### 1.2 ç¾æœ‰åŠŸèƒ½å„ªå‹¢
- âœ… åŸºç¤WordPressåƒæ•¸è‡ªå‹•æå–ï¼ˆæ¨™é¡Œã€åˆ†é¡ã€æ¨™ç±¤ç­‰ï¼‰
- âœ… æ¨™é¡Œèˆ‡å…§å®¹çµ±ä¸€ç·¨è¼¯é«”é©—
- âœ… ç‰¹è‰²åœ–ç‰‡è‡ªå‹•æå–èˆ‡è™•ç†
- âœ… å¤šå±¤éŒ¯èª¤è™•ç†èˆ‡å›é€€æ©Ÿåˆ¶
- âœ… ä¸‰ç¨®æ“ä½œæ¨¡å¼æ”¯æ´ï¼ˆå…¨è‡ªå‹•ã€åŠè‡ªå‹•ã€æ‰‹å‹•ï¼‰

### 1.3 ç¾æœ‰æ¶æ§‹é™åˆ¶
- âŒ æ‰€æœ‰æ ¼å¼åŒ–é‚è¼¯é›†ä¸­åœ¨copy-editingéšæ®µ
- âŒ AIè² è²¬è™•ç†åš´æ ¼æ ¼å¼è¦æ±‚ï¼ˆä¸å¯é ï¼‰
- âŒ ç¼ºä¹æ–‡ç¨¿åˆ†é¡æ©Ÿåˆ¶
- âŒ æ²’æœ‰æ¨¡æ¿åŒ–çš„æ ¼å¼æ‡‰ç”¨ç³»çµ±

## 2. æ–°éœ€æ±‚åˆ†æ

### 2.1 å»£ç·¨ç¨¿ç‰¹æ®Šéœ€æ±‚
**æŠ¼è¨»è¦æ±‚**ï¼š
- æ­£æ–‡å‰æ–¹æŠ¼è¨»ï¼š
  ```html
  <span style="color: #808080;"><em>æœ¬æ–‡ç‚ºå»£ç·¨ç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ï¼Œäº¦éæŠ•è³‡å»ºè­°ã€è³¼è²·æˆ–å‡ºå”®å»ºè­°ã€‚è©³è¦‹æ–‡æœ«è²¬ä»»è­¦ç¤ºã€‚</em></span>
  ```
- æ­£æ–‡æ–‡æœ«æŠ¼è¨»ï¼š
  ```html
  <div class="alert alert-warning">å»£ç·¨å…è²¬è²æ˜ï¼šæœ¬æ–‡å…§å®¹ç‚ºä¾›ç¨¿è€…æä¾›ä¹‹å»£å®£ç¨¿ä»¶ï¼Œä¾›ç¨¿è€…èˆ‡å‹•å€ä¸¦ç„¡ä»»ä½•é—œä¿‚ï¼Œæœ¬æ–‡äº¦ä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚æœ¬æ–‡ç„¡æ„æä¾›ä»»ä½•æŠ•è³‡ã€è³‡ç”¢å»ºè­°æˆ–æ³•å¾‹æ„è¦‹ï¼Œä¹Ÿä¸æ‡‰è¢«è¦–ç‚ºè³¼è²·ã€å‡ºå”®æˆ–æŒæœ‰è³‡ç”¢çš„è¦ç´„ã€‚å»£å®£ç¨¿ä»¶å…§å®¹æ‰€æåŠä¹‹ä»»ä½•æœå‹™ã€æ–¹æ¡ˆæˆ–å·¥å…·ç­‰åƒ…ä¾›åƒè€ƒï¼Œä¸”æœ€çµ‚å¯¦éš›å…§å®¹æˆ–è¦å‰‡ä»¥ä¾›ç¨¿æ–¹ä¹‹å…¬å¸ƒæˆ–èªªæ˜ç‚ºæº–ï¼Œå‹•å€ä¸å°ä»»ä½•å¯èƒ½å­˜åœ¨ä¹‹é¢¨éšªæˆ–æå¤±è² è²¬ï¼Œæé†’è®€è€…é€²è¡Œä»»ä½•æ±ºç­–æˆ–è¡Œç‚ºå‰å‹™å¿…è‡ªè¡Œè¬¹æ…æŸ¥æ ¸ã€‚</div>
  ```
- ä½œè€…è¨­å®šï¼šã€Œå»£ç·¨é »é“ï¼ˆBTEditorï¼‰ã€
- å°é¢åœ–ç‰‡ï¼šéœ€è¦å¥—å…¥ADæ¨¡æ¿ï¼ˆå³ä¸Šè§’ADæ¨™ç¤ºï¼‰
- ADæ¨¡æ¿é€£çµï¼šhttps://www.canva.com/design/DAFvcOqDOD8/msglmQ4I-dU3Pq8R9m2mlg/edit

**å®Œæ•´å»£ç·¨ç¨¿HTMLæ¨¡æ¿**ï¼š
```html
<p class="intro_quote">AI æ‘˜è¦å¼•è¨€

ï¼ˆå‰æƒ…æè¦ï¼š<span style="color: #ff6600;"><a style="color: #ff6600;" href="[å‰æƒ…æ–‡ç« URL]" target="_blank" rel="noopener">[å‰æƒ…æ–‡ç« æ¨™é¡Œ]</a></span>ï¼‰

ï¼ˆèƒŒæ™¯è£œå……ï¼š<span style="color: #ff6600;"><a style="color: #ff6600;" href="[èƒŒæ™¯æ–‡ç« URL]" target="_blank" rel="noopener">[èƒŒæ™¯æ–‡ç« æ¨™é¡Œ]</a></span>ï¼‰</p>

&nbsp;

<span style="color: #808080;"><em>æœ¬æ–‡ç‚ºå»£ç·¨ç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ï¼Œäº¦éæŠ•è³‡å»ºè­°ã€è³¼è²·æˆ–å‡ºå”®å»ºè­°ã€‚è©³è¦‹æ–‡æœ«è²¬ä»»è­¦ç¤ºã€‚</em></span>

<hr />

<span class="dropcap " style="background-color: #ffffff; color: #000000; border-color: #ffffff;">[ç¬¬ä¸€å€‹å­—]</span> [æ­£æ–‡å…§å®¹]

[æ–‡ç« å…§å®¹...]

ï¼¿ï¼¿ï¼¿

<div class="alert alert-warning">å»£ç·¨å…è²¬è²æ˜ï¼šæœ¬æ–‡å…§å®¹ç‚ºä¾›ç¨¿è€…æä¾›ä¹‹å»£å®£ç¨¿ä»¶ï¼Œä¾›ç¨¿è€…èˆ‡å‹•å€ä¸¦ç„¡ä»»ä½•é—œä¿‚ï¼Œæœ¬æ–‡äº¦ä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚æœ¬æ–‡ç„¡æ„æä¾›ä»»ä½•æŠ•è³‡ã€è³‡ç”¢å»ºè­°æˆ–æ³•å¾‹æ„è¦‹ï¼Œä¹Ÿä¸æ‡‰è¢«è¦–ç‚ºè³¼è²·ã€å‡ºå”®æˆ–æŒæœ‰è³‡ç”¢çš„è¦ç´„ã€‚å»£å®£ç¨¿ä»¶å…§å®¹æ‰€æåŠä¹‹ä»»ä½•æœå‹™ã€æ–¹æ¡ˆæˆ–å·¥å…·ç­‰åƒ…ä¾›åƒè€ƒï¼Œä¸”æœ€çµ‚å¯¦éš›å…§å®¹æˆ–è¦å‰‡ä»¥ä¾›ç¨¿æ–¹ä¹‹å…¬å¸ƒæˆ–èªªæ˜ç‚ºæº–ï¼Œå‹•å€ä¸å°ä»»ä½•å¯èƒ½å­˜åœ¨ä¹‹é¢¨éšªæˆ–æå¤±è² è²¬ï¼Œæé†’è®€è€…é€²è¡Œä»»ä½•æ±ºç­–æˆ–è¡Œç‚ºå‰å‹™å¿…è‡ªè¡Œè¬¹æ…æŸ¥æ ¸ã€‚</div>

<a href="https://t.me/blocktemponews/"><img class="alignnone wp-image-194701 size-full" src="https://image.blocktempo.com/2022/11/å‹•å€å®˜ç¶²tg-banner-1116.png" alt="" width="800" height="164" /></a>

<h5>ğŸ“ç›¸é—œå ±å°ğŸ“</h5>
[2-4å€‹ç›¸é—œæ–‡ç« é€£çµï¼Œæ ¼å¼ç‚ºç²—é«”]
```

### 2.2 æ–°èç¨¿ç‰¹æ®Šéœ€æ±‚
**æŠ¼è¨»è¦æ±‚**ï¼š
- åƒ…éœ€æ­£æ–‡å‰æ–¹æŠ¼è¨»ï¼š
  ```html
  <span style="color: #808080;"><em>æœ¬æ–‡ç‚ºæ–°èç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚</em></span>
  ```
- ç„¡éœ€æ–‡æœ«å…è²¬è²æ˜
- ä½œè€…è¨­å®šï¼šã€ŒBTå®™åŸŸï¼ˆBTVerseï¼‰ã€
- å°é¢åœ–ç‰‡ï¼šä¸éœ€è¦ADæ¨¡æ¿

**å®Œæ•´æ–°èç¨¿HTMLæ¨¡æ¿**ï¼š
```html
<p class="intro_quote">AI æ‘˜è¦å¼•è¨€
ï¼ˆå‰æƒ…æè¦ï¼š<span style="color: #ff6600;"><a style="color: #ff6600;" href="[å‰æƒ…æ–‡ç« URL]" target="_blank" rel="noopener">[å‰æƒ…æ–‡ç« æ¨™é¡Œ]</a></span>ï¼‰
ï¼ˆèƒŒæ™¯è£œå……ï¼š<span style="color: #ff6600;"><a style="color: #ff6600;" href="[èƒŒæ™¯æ–‡ç« URL]" target="_blank" rel="noopener">[èƒŒæ™¯æ–‡ç« æ¨™é¡Œ]</a></span>ï¼‰</p>

<span style="color: #808080;"><em>æœ¬æ–‡ç‚ºæ–°èç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚</em></span>

<hr />

<span style="font-weight: 400;"><span class="dropcap " style="background-color: #ffffff; color: #000000; border-color: #ffffff;">[ç¬¬ä¸€å€‹å­—]</span> [æ­£æ–‡å…§å®¹]

[æ–‡ç« å…§å®¹...]

<a href="https://t.me/blocktemponews/"><img class="alignnone wp-image-194701 size-full" src="https://image.blocktempo.com/2022/11/å‹•å€å®˜ç¶²tg-banner-1116.png" alt="" width="800" height="164" /></a>
<h5>ğŸ“ç›¸é—œå ±å°ğŸ“</h5>
[2-4å€‹ç›¸é—œæ–‡ç« é€£çµï¼Œæ ¼å¼ç‚ºç²—é«”]
```

### 2.3 å…±åŒæ ¼å¼è¦æ±‚
**å…§å®¹æ ¼å¼è¦æ±‚**ï¼š
- ~~ä¸è¦å°‡ç™¼å¸ƒæ™‚é–“è§£ç¦æ•˜è¿°æŠ“å–é€²æ­£æ–‡ï¼ˆå¦‚ï¼šEMBARGOED TILL 9 MAY 2025, 11:00 AM GMT+8ï¼‰~~ï¼ˆå·²åœ¨å‰é¢AIæµç¨‹å¯¦ç¾ï¼‰
- ç¬¬ä¸€æ®µé–‹é ­ç¬¬ä¸€å€‹å­—ä½¿ç”¨Dropcapæ ¼å¼ï¼š
  ```html
  <span class="dropcap " style="background-color: #ffffff; color: #000000; border-color: #ffffff;">[å­—]</span>
  ```
- ~~è‹±æ–‡å’Œæ•¸å­—å‰å¾Œè¦ç©ºåŠæ ¼ï¼ˆæ®µé¦–é™¤å¤–ï¼‰~~ï¼ˆå·²åœ¨å‰é¢AIæµç¨‹å¯¦ç¾ï¼‰
- æ®µè½æ¨™é¡Œå„ªå…ˆè¨­ç‚ºã€Œæ¨™é¡Œä¸‰ã€
- å…§æ–‡æ¨™é¡Œå±¤ç´šï¼šæ¨™é¡Œä¸‰ > æ¨™é¡Œå›› > æ®µè½/Textï¼ˆç²—é«”ï¼‰
- ~~ä¸­åœ‹ç”¨èªè½‰å°ç£ç”¨èªï¼š~~ï¼ˆå·²åœ¨å‰é¢AIæµç¨‹å¯¦ç¾ï¼‰
  - ~~ç¶²çµ¡ â†’ ç¶²è·¯~~
  - ~~ä¿¡æ¯ â†’ è³‡è¨Š/è¨Šæ¯ï¼ˆä¾ä¸Šä¸‹æ–‡åˆ¤æ–·ï¼‰~~

**å¼•è¨€èˆ‡é—œè¯æ–‡ç« è¦æ±‚**ï¼š
- æ–‡ç« æœ‰å‰¯æ¨™é¡Œï¼šç›´æ¥å°‡å‰¯æ¨™é¡Œä½œç‚ºå¼•è¨€
- ç„¡å‰¯æ¨™é¡Œï¼šAIæ‘˜è¦å…¨æ–‡é‡é»ï¼Œä¸è¶…é100å­—
- å¼•è¨€å€å¡Šä½¿ç”¨ `intro_quote` class
- å‰æƒ…æè¦ã€èƒŒæ™¯è£œå……ï¼šå¾BlockTempoæœå°‹ç›¸é—œæ–‡ç« 
- å¼•è¨€æ ¼å¼æ¨¡æ¿ï¼š
  ```html
  <p class="intro_quote">AI æ‘˜è¦å¼•è¨€

  ï¼ˆå‰æƒ…æè¦ï¼š<span style="color: #ff6600;"><a style="color: #ff6600;" href="[URL]" target="_blank" rel="noopener">[æ¨™é¡Œ]</a></span>ï¼‰

  ï¼ˆèƒŒæ™¯è£œå……ï¼š<span style="color: #ff6600;"><a style="color: #ff6600;" href="[URL]" target="_blank" rel="noopener">[æ¨™é¡Œ]</a></span>ï¼‰</p>
  ```

**æ–‡æœ«é€£çµè¦å‰‡**ï¼š
- æœ€å¤šå¯æ”¾3å€‹é€£çµ
- éœ€åˆªé™¤Telegramï¼ˆTGï¼‰ã€LINEç¤¾ç¾¤é€£çµ
- è‹¥è¶…é3å€‹ï¼Œé¸æ“‡æ’é™¤TG/LINEçš„å‰ä¸‰å€‹é€£çµ
- ç›¸é—œé–±è®€é€£çµæ ¼å¼ç‚ºç²—é«”ï¼š
  ```html
  <strong><span style="color: #ff0000;"><a href="[URL]">[æ¨™é¡Œ]</a></span></strong>
  <strong><a href="[URL]">[æ¨™é¡Œ]</a></strong>
  ```

**æ°¸ä¹…é€£çµè™•ç†**ï¼šï¼ˆå·²åœ¨å‰é¢AIæµç¨‹å¯¦ç¾ï¼‰
- ~~å°‡æ–‡ç« æ¨™é¡Œç¿»è­¯ç‚ºè‹±æ–‡~~
- ~~å…¨éƒ¨å°å¯«ï¼Œå–®å­—é–“ç”¨ `-` é€£æ¥~~
- ~~ç¯„ä¾‹ï¼š`t-rex-raises-17m-to-reshape-web3s-attention-economy-layer`~~

## 3. å»ºè­°æ¶æ§‹æ–¹æ¡ˆï¼šåƒæ•¸é©…å‹•çš„éˆæ´»è™•ç†

### 3.1 æ ¸å¿ƒè¨­è¨ˆåŸå‰‡
1. **åƒæ•¸é©…å‹•** vs **é¡å‹é©…å‹•**ï¼šè™•ç†é‚è¼¯åŸºæ–¼å…·é«”çš„é€²éšè¨­å®šåƒæ•¸ï¼Œè€Œéæ–‡ç¨¿é¡å‹
2. **é è¨­ä¾¿åˆ©æ€§** vs **ç”¨æˆ¶è‡ªç”±åº¦**ï¼šæ–‡ç¨¿é¡å‹æä¾›é è¨­è¨­å®šï¼Œä½†ç”¨æˆ¶å¯å®Œå…¨è‡ªè¨‚
3. **æ¨¡æ¿åŒ–åŸ·è¡Œ** vs **AIæ™ºèƒ½åˆ†æ**ï¼šåš´æ ¼æ ¼å¼ç”¨æ¨¡æ¿ï¼Œæ™ºèƒ½å…§å®¹ç”¨AI

### 3.2 æ–°æ¶æ§‹æµç¨‹åœ–
```
upload (æ–‡ç¨¿åˆ†é¡+é€²éšè¨­å®š) â†’ extract â†’ process â†’ advanced-ai â†’ format-conversion â†’ 
copy-editing (AIæ™ºèƒ½åˆ†æ) â†’ article-formatting (åƒæ•¸é©…å‹•æ¨¡æ¿æ‡‰ç”¨) â†’ prep-publish â†’ publish-news
```

### 3.3 å„éšæ®µè·è²¬é‡æ–°åŠƒåˆ†

#### éšæ®µ1ï¼šæ–‡ç¨¿åˆ†é¡èˆ‡é€²éšè¨­å®š (uploadå¼·åŒ–)
**ä½ç½®**ï¼šuploadéšæ®µå¢åŠ æ–‡ç¨¿é¡å‹é¸æ“‡å’Œé€²éšè¨­å®š
**è·è²¬**ï¼š
- ç”¨æˆ¶é¸æ“‡æ–‡ç¨¿é¡å‹ï¼š`å»£ç·¨ç¨¿` / `æ–°èç¨¿` / `ä¸€èˆ¬æ–‡ç« `
- ç³»çµ±æä¾›å°æ‡‰çš„é è¨­é€²éšè¨­å®š
- ç”¨æˆ¶å¯èª¿æ•´ä»»ä½•é€²éšè¨­å®šï¼Œä¸å—æ–‡ç¨¿é¡å‹é™åˆ¶
- è¨˜éŒ„æœ€çµ‚ç¢ºå®šçš„é€²éšè¨­å®šåˆ°è™•ç†ç‹€æ…‹

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
```typescript
// âŒ éŒ¯èª¤çš„é¡å‹é©…å‹•æ–¹å¼
if (articleType === 'sponsored') {
  addHeaderDisclaimer(); // ç¡¬ç·¨ç¢¼é‚è¼¯
}

// âœ… æ­£ç¢ºçš„åƒæ•¸é©…å‹•æ–¹å¼  
if (advancedSettings.headerDisclaimer === 'sponsored') {
  addHeaderDisclaimer(); // åŸºæ–¼ç”¨æˆ¶è¨­å®š
}
```

**é€²éšè¨­å®šçµæ§‹**ï¼š
```typescript
interface AdvancedArticleSettings {
  headerDisclaimer: DisclaimerType; // 'none' | 'sponsored' | 'press-release'
  footerDisclaimer: DisclaimerType; // 'none' | 'sponsored' | 'press-release'  
  authorName?: string; // ä¾›ç¨¿æ–¹åç¨±ï¼Œç”¨æ–¼å‹•æ…‹æ›¿æ›
}

// ä½¿ç”¨ç¯„ä¾‹ï¼šå»£ç·¨ç¨¿ä½†ä¸æŠ¼è¨»
const customSettings: AdvancedArticleSettings = {
  headerDisclaimer: 'none',    // ç”¨æˆ¶é¸æ“‡ä¸æŠ¼è¨»
  footerDisclaimer: 'none',    // ç”¨æˆ¶é¸æ“‡ä¸æŠ¼è¨»
  authorName: 'æŸæŸå…¬å¸'       // ä»å¯è¨­å®šä¾›ç¨¿æ–¹
};
```

#### éšæ®µ2ï¼šAIæ™ºèƒ½åˆ†æéšæ®µ (copy-editingå¼·åŒ–)
**ä½ç½®**ï¼šç¾æœ‰copy-editingéšæ®µ
**AIé©åˆè™•ç†çš„ä»»å‹™**ï¼š
- âœ… é—œè¯æ–‡ç« æœå°‹ï¼ˆå‰æƒ…æè¦ã€èƒŒæ™¯è£œå……ã€ç›¸é—œé–±è®€ï¼‰
- âœ… ä¸­æ–‡ç”¨èªè½‰æ›ï¼ˆç¶²çµ¡â†’ç¶²è·¯ã€ä¿¡æ¯â†’è³‡è¨Šï¼‰
- âœ… å…§å®¹æ‘˜è¦ç”Ÿæˆ
- âœ… æ°¸ä¹…é€£çµè‹±æ–‡ç¿»è­¯
- âœ… åŸºç¤WordPressåƒæ•¸æå–
- âœ… æ’°ç¨¿æ–¹åç¨±è­˜åˆ¥

**é‡è¦**ï¼šAIéšæ®µä¸è™•ç†ä»»ä½•æ ¼å¼æ¨¡æ¿ï¼Œåªè² è²¬å…§å®¹åˆ†æå’Œæº–å‚™æ•¸æ“š

#### éšæ®µ3ï¼šåƒæ•¸é©…å‹•æ ¼å¼æ¨¡æ¿æ‡‰ç”¨éšæ®µ (æ–°å¢ article-formatting)
**ä½ç½®**ï¼šprep-publishä¹‹å‰æ–°å¢ç¨ç«‹éšæ®µ
**æ ¸å¿ƒé‚è¼¯**ï¼šå®Œå…¨åŸºæ–¼ `AdvancedArticleSettings` åƒæ•¸æ±ºå®šè™•ç†

```typescript
class ParameterDrivenFormattingProcessor {
  async formatArticle(
    content: string, 
    advancedSettings: AdvancedArticleSettings,
    analysisResult: EnhancedCopyEditingResult
  ) {
    let formattedContent = content;
    
    // 1. æ ¹æ“š headerDisclaimer åƒæ•¸æ±ºå®šé–‹é ­æŠ¼è¨»
    if (advancedSettings.headerDisclaimer !== 'none') {
      const disclaimerTemplate = this.getDisclaimerTemplate(
        advancedSettings.headerDisclaimer,
        'header'
      );
      if (disclaimerTemplate && advancedSettings.authorName) {
        const disclaimer = disclaimerTemplate.replace(
          'ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½', 
          advancedSettings.authorName
        );
        formattedContent = this.insertHeaderDisclaimer(formattedContent, disclaimer);
      }
    }
    
    // 2. æ ¹æ“š footerDisclaimer åƒæ•¸æ±ºå®šçµå°¾æŠ¼è¨»
    if (advancedSettings.footerDisclaimer !== 'none') {
      const disclaimerTemplate = this.getDisclaimerTemplate(
        advancedSettings.footerDisclaimer,
        'footer'
      );
      if (disclaimerTemplate) {
        formattedContent = this.insertFooterDisclaimer(formattedContent, disclaimerTemplate);
      }
    }
    
    // 3. å…¶ä»–æ ¼å¼è™•ç†ï¼ˆDropcapã€é—œè¯æ–‡ç« ç­‰ï¼‰
    formattedContent = this.applyOtherFormatting(formattedContent, analysisResult);
    
    return {
      formattedContent,
      appliedSettings: advancedSettings,
      metadata: {
        hasHeaderDisclaimer: advancedSettings.headerDisclaimer !== 'none',
        hasFooterDisclaimer: advancedSettings.footerDisclaimer !== 'none',
        authorName: advancedSettings.authorName,
        processingTime: Date.now()
      }
    };
  }
  
  private getDisclaimerTemplate(type: DisclaimerType, position: 'header' | 'footer'): string | null {
    const templates = {
      sponsored: {
        header: '<span style="color: #808080;"><em>æœ¬æ–‡ç‚ºå»£ç·¨ç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ï¼Œäº¦éæŠ•è³‡å»ºè­°ã€è³¼è²·æˆ–å‡ºå”®å»ºè­°ã€‚è©³è¦‹æ–‡æœ«è²¬ä»»è­¦ç¤ºã€‚</em></span>',
        footer: '<div class="alert alert-warning">å»£ç·¨å…è²¬è²æ˜ï¼šæœ¬æ–‡å…§å®¹ç‚ºä¾›ç¨¿è€…æä¾›ä¹‹å»£å®£ç¨¿ä»¶ï¼Œä¾›ç¨¿è€…èˆ‡å‹•å€ä¸¦ç„¡ä»»ä½•é—œä¿‚ï¼Œæœ¬æ–‡äº¦ä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚æœ¬æ–‡ç„¡æ„æä¾›ä»»ä½•æŠ•è³‡ã€è³‡ç”¢å»ºè­°æˆ–æ³•å¾‹æ„è¦‹ï¼Œä¹Ÿä¸æ‡‰è¢«è¦–ç‚ºè³¼è²·ã€å‡ºå”®æˆ–æŒæœ‰è³‡ç”¢çš„è¦ç´„ã€‚å»£å®£ç¨¿ä»¶å…§å®¹æ‰€æåŠä¹‹ä»»ä½•æœå‹™ã€æ–¹æ¡ˆæˆ–å·¥å…·ç­‰åƒ…ä¾›åƒè€ƒï¼Œä¸”æœ€çµ‚å¯¦éš›å…§å®¹æˆ–è¦å‰‡ä»¥ä¾›ç¨¿æ–¹ä¹‹å…¬å¸ƒæˆ–èªªæ˜ç‚ºæº–ï¼Œå‹•å€ä¸å°ä»»ä½•å¯èƒ½å­˜åœ¨ä¹‹é¢¨éšªæˆ–æå¤±è² è²¬ï¼Œæé†’è®€è€…é€²è¡Œä»»ä½•æ±ºç­–æˆ–è¡Œç‚ºå‰å‹™å¿…è‡ªè¡Œè¬¹æ…æŸ¥æ ¸ã€‚</div>'
      },
      'press-release': {
        header: '<span style="color: #808080;"><em>æœ¬æ–‡ç‚ºæ–°èç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚</em></span>',
        footer: null
      }
    };
    
    return templates[type]?.[position] || null;
  }
}
```

### 3.4 åƒæ•¸é©…å‹•çš„é è¨­é…ç½®

#### æ–‡ç¨¿é¡å‹é è¨­å€¼ï¼ˆå¯è¢«ç”¨æˆ¶è¦†è“‹ï¼‰
```typescript
export const DefaultAdvancedSettings: Record<ArticleType, AdvancedArticleSettings> = {
  regular: {
    headerDisclaimer: 'none',           // é è¨­ä¸æŠ¼è¨»
    footerDisclaimer: 'none',           // é è¨­ä¸æŠ¼è¨»
    authorName: undefined               // ç„¡é è¨­ä¾›ç¨¿æ–¹
  },
  sponsored: {
    headerDisclaimer: 'sponsored',      // é è¨­å»£ç·¨ç¨¿æŠ¼è¨»
    footerDisclaimer: 'sponsored',      // é è¨­å»£ç·¨ç¨¿æŠ¼è¨»
    authorName: undefined               // ç­‰å¾…ç”¨æˆ¶è¼¸å…¥
  },
  'press-release': {
    headerDisclaimer: 'press-release',  // é è¨­æ–°èç¨¿æŠ¼è¨»
    footerDisclaimer: 'none',           // é è¨­ä¸æŠ¼è¨»
    authorName: undefined               // ç­‰å¾…ç”¨æˆ¶è¼¸å…¥
  }
};

// ç”¨æˆ¶è‡ªè¨‚ç¯„ä¾‹ï¼šå»£ç·¨ç¨¿ä½†é¸æ“‡ä¸æŠ¼è¨»
const userCustomSettings: AdvancedArticleSettings = {
  headerDisclaimer: 'none',      // ç”¨æˆ¶æ”¹ç‚ºä¸æŠ¼è¨»
  footerDisclaimer: 'none',      // ç”¨æˆ¶æ”¹ç‚ºä¸æŠ¼è¨»
  authorName: 'æŸæŸç§‘æŠ€å…¬å¸'     // ç”¨æˆ¶å¡«å…¥ä¾›ç¨¿æ–¹
};
```

#### æŠ¼è¨»æ¨¡æ¿åº«ï¼ˆæ”¯æ´æ“´å±•ï¼‰
```typescript
export const DisclaimerTemplates = {
  sponsored: {
    name: 'å»£ç·¨ç¨¿æŠ¼è¨»',
    header: '<span style="color: #808080;"><em>æœ¬æ–‡ç‚ºå»£ç·¨ç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ï¼Œäº¦éæŠ•è³‡å»ºè­°ã€è³¼è²·æˆ–å‡ºå”®å»ºè­°ã€‚è©³è¦‹æ–‡æœ«è²¬ä»»è­¦ç¤ºã€‚</em></span>',
    footer: '<div class="alert alert-warning">å»£ç·¨å…è²¬è²æ˜ï¼šæœ¬æ–‡å…§å®¹ç‚ºä¾›ç¨¿è€…æä¾›ä¹‹å»£å®£ç¨¿ä»¶ï¼Œä¾›ç¨¿è€…èˆ‡å‹•å€ä¸¦ç„¡ä»»ä½•é—œä¿‚ï¼Œæœ¬æ–‡äº¦ä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚æœ¬æ–‡ç„¡æ„æä¾›ä»»ä½•æŠ•è³‡ã€è³‡ç”¢å»ºè­°æˆ–æ³•å¾‹æ„è¦‹ï¼Œä¹Ÿä¸æ‡‰è¢«è¦–ç‚ºè³¼è²·ã€å‡ºå”®æˆ–æŒæœ‰è³‡ç”¢çš„è¦ç´„ã€‚å»£å®£ç¨¿ä»¶å…§å®¹æ‰€æåŠä¹‹ä»»ä½•æœå‹™ã€æ–¹æ¡ˆæˆ–å·¥å…·ç­‰åƒ…ä¾›åƒè€ƒï¼Œä¸”æœ€çµ‚å¯¦éš›å…§å®¹æˆ–è¦å‰‡ä»¥ä¾›ç¨¿æ–¹ä¹‹å…¬å¸ƒæˆ–èªªæ˜ç‚ºæº–ï¼Œå‹•å€ä¸å°ä»»ä½•å¯èƒ½å­˜åœ¨ä¹‹é¢¨éšªæˆ–æå¤±è² è²¬ï¼Œæé†’è®€è€…é€²è¡Œä»»ä½•æ±ºç­–æˆ–è¡Œç‚ºå‰å‹™å¿…è‡ªè¡Œè¬¹æ…æŸ¥æ ¸ã€‚</div>',
    authorPlaceholder: 'ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½'
  },
  'press-release': {
    name: 'æ–°èç¨¿æŠ¼è¨»',
    header: '<span style="color: #808080;"><em>æœ¬æ–‡ç‚ºæ–°èç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚</em></span>',
    footer: null,
    authorPlaceholder: 'ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½'
  },
  none: {
    name: 'ä¸æŠ¼è¨»',
    header: null,
    footer: null,
    authorPlaceholder: null
  }
};
```

### 3.5 éˆæ´»æ€§å±•ç¤ºç¯„ä¾‹

#### ç¯„ä¾‹1ï¼šæ¨™æº–å»£ç·¨ç¨¿
```typescript
const standardSponsored: AdvancedArticleSettings = {
  headerDisclaimer: 'sponsored',    // å»£ç·¨ç¨¿é–‹é ­æŠ¼è¨»
  footerDisclaimer: 'sponsored',    // å»£ç·¨ç¨¿çµå°¾æŠ¼è¨»
  authorName: 'ABCç§‘æŠ€å…¬å¸'         // ä¾›ç¨¿æ–¹åç¨±
};
// çµæœï¼šå®Œæ•´çš„å»£ç·¨ç¨¿æ ¼å¼ï¼ŒåŒ…å«é–‹é ­å’Œçµå°¾æŠ¼è¨»
```

#### ç¯„ä¾‹2ï¼šç°¡åŒ–å»£ç·¨ç¨¿ï¼ˆä¸è¦çµå°¾æŠ¼è¨»ï¼‰
```typescript
const simplifiedSponsored: AdvancedArticleSettings = {
  headerDisclaimer: 'sponsored',    // ä¿ç•™é–‹é ­æŠ¼è¨»
  footerDisclaimer: 'none',         // ä¸è¦çµå°¾æŠ¼è¨»
  authorName: 'ABCç§‘æŠ€å…¬å¸'         // ä¾›ç¨¿æ–¹åç¨±
};
// çµæœï¼šåªæœ‰é–‹é ­æŠ¼è¨»çš„ç°¡åŒ–å»£ç·¨ç¨¿
```

#### ç¯„ä¾‹3ï¼šç„¡æŠ¼è¨»å»£ç·¨ç¨¿ï¼ˆç´”å…§å®¹ï¼‰
```typescript
const noBrandingSponsored: AdvancedArticleSettings = {
  headerDisclaimer: 'none',         // ä¸è¦é–‹é ­æŠ¼è¨»
  footerDisclaimer: 'none',         // ä¸è¦çµå°¾æŠ¼è¨»
  authorName: 'ABCç§‘æŠ€å…¬å¸'         // åƒ…è¨˜éŒ„ä¾›ç¨¿æ–¹
};
// çµæœï¼šç´”ç²¹çš„æ–‡ç« å…§å®¹ï¼Œç„¡ä»»ä½•æŠ¼è¨»
```

#### ç¯„ä¾‹4ï¼šæ··åˆæŠ¼è¨»ï¼ˆå»£ç·¨ç¨¿ç”¨æ–°èç¨¿æŠ¼è¨»ï¼‰
```typescript
const hybridSponsored: AdvancedArticleSettings = {
  headerDisclaimer: 'press-release', // ä½¿ç”¨æ–°èç¨¿æŠ¼è¨»
  footerDisclaimer: 'none',          // ä¸è¦çµå°¾æŠ¼è¨»
  authorName: 'ABCç§‘æŠ€å…¬å¸'          // ä¾›ç¨¿æ–¹åç¨±
};
// çµæœï¼šä½¿ç”¨æ–°èç¨¿æŠ¼è¨»æ ¼å¼çš„å»£ç·¨ç¨¿
```

## 4. å…·é«”å¯¦æ–½å»ºè­°

### 4.1 å‰ç«¯UIæ”¹é€²

#### é€²éšæ–‡ç¨¿è¨­å®šé¸æ“‡å™¨ (uploadéšæ®µ)
```typescript
const AdvancedArticleSelector = () => (
  <div className="article-settings mb-4">
    <div className="flex items-center space-x-4 flex-wrap gap-y-3">
      {/* æ–‡ç¨¿é¡å‹é¸æ“‡ - æä¾›é è¨­å€¼ */}
      <div className="flex items-center space-x-2">
        <label className="block text-sm font-medium mb-2">æ–‡ç¨¿é¡å‹ï¼š</label>
        <select 
          value={selectedType}
          onChange={handleTypeChange} // è§¸ç™¼é è¨­å€¼è¼‰å…¥
          className="w-full p-2 border rounded"
        >
          <option value="regular">ä¸€èˆ¬æ–‡ç« </option>
          <option value="sponsored">å»£ç·¨ç¨¿</option>
          <option value="press-release">æ–°èç¨¿</option>
        </select>
      </div>

      {/* é–‹é ­æŠ¼è¨»é¸æ“‡ - å¯è‡ªç”±èª¿æ•´ */}
      <div className="flex items-center space-x-2">
        <label className="text-sm font-medium">æ­£æ–‡é–‹é ­æŠ¼è¨»ï¼š</label>
        <select 
          value={advancedSettings.headerDisclaimer}
          onChange={handleHeaderDisclaimerChange}
          className="rounded-md border px-3 py-1.5 text-sm"
        >
          <option value="none">ä¸æŠ¼è¨»</option>
          <option value="sponsored">å»£ç·¨ç¨¿æŠ¼è¨»</option>
          <option value="press-release">æ–°èç¨¿æŠ¼è¨»</option>
        </select>
      </div>

      {/* çµå°¾æŠ¼è¨»é¸æ“‡ - å¯è‡ªç”±èª¿æ•´ */}
      <div className="flex items-center space-x-2">
        <label className="text-sm font-medium">æ­£æ–‡æœ«å°¾æŠ¼è¨»ï¼š</label>
        <select 
          value={advancedSettings.footerDisclaimer}
          onChange={handleFooterDisclaimerChange}
          className="rounded-md border px-3 py-1.5 text-sm"
        >
          <option value="none">ä¸æŠ¼è¨»</option>
          <option value="sponsored">å»£ç·¨ç¨¿æŠ¼è¨»</option>
          <option value="press-release">æ–°èç¨¿æŠ¼è¨»</option>
        </select>
      </div>
    </div>

    {/* ä¾›ç¨¿æ–¹è¼¸å…¥ - ç¨ç«‹ä¸€è¡Œ */}
    <div className="flex items-center space-x-2 mt-3">
      <label className="text-sm font-medium">ä¾›ç¨¿æ–¹ï¼š</label>
      <input
        type="text"
        value={advancedSettings.authorName || ''}
        onChange={handleAuthorNameChange}
        placeholder="è¼¸å…¥ä¾›ç¨¿æ–¹åç¨±ï¼ˆé¸å¡«ï¼‰"
        className="rounded-md border px-3 py-1.5 text-sm min-w-[200px]"
      />
      <span className="text-xs text-gray-500">
        ç”¨æ–¼è‡ªå‹•æ›¿æ›æŠ¼è¨»ä¸­çš„ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½
      </span>
    </div>

    {/* å¯¦æ™‚é è¦½ç•¶å‰è¨­å®š */}
    <div className="mt-3 p-3 bg-gray-50 rounded-lg">
      <p className="text-sm text-gray-600">
        <strong>ç•¶å‰è¨­å®šé è¦½ï¼š</strong>
        {advancedSettings.headerDisclaimer !== 'none' && (
          <span className="text-blue-600"> é–‹é ­æŠ¼è¨»ï¼š{getDisclaimerName(advancedSettings.headerDisclaimer)}</span>
        )}
        {advancedSettings.footerDisclaimer !== 'none' && (
          <span className="text-blue-600"> çµå°¾æŠ¼è¨»ï¼š{getDisclaimerName(advancedSettings.footerDisclaimer)}</span>
        )}
        {advancedSettings.headerDisclaimer === 'none' && advancedSettings.footerDisclaimer === 'none' && (
          <span className="text-gray-500"> ç„¡æŠ¼è¨»ï¼Œç´”å…§å®¹æ ¼å¼</span>
        )}
        {advancedSettings.authorName && (
          <span className="text-green-600"> ä¾›ç¨¿æ–¹ï¼š{advancedSettings.authorName}</span>
        )}
      </p>
    </div>
  </div>
);
```

### 4.2 å¾Œç«¯è™•ç†é‚è¼¯é‡æ§‹

#### åƒæ•¸é©…å‹•çš„æ–‡ç« æ ¼å¼åŒ–è™•ç†å™¨
```typescript
class ParameterDrivenArticleFormatter {
  /**
   * æ ¸å¿ƒæ ¼å¼åŒ–é‚è¼¯ - å®Œå…¨åŸºæ–¼åƒæ•¸æ±ºå®š
   */
  async formatArticle(
    content: string,
    advancedSettings: AdvancedArticleSettings,
    analysisResult: EnhancedCopyEditingResult
  ): Promise<ArticleFormattingResult> {
    
    let formattedContent = content;
    const appliedRules: string[] = [];
    
    // 1. è™•ç†é–‹é ­æŠ¼è¨» - åŸºæ–¼ headerDisclaimer åƒæ•¸
    if (advancedSettings.headerDisclaimer !== 'none') {
      const headerResult = await this.applyHeaderDisclaimer(
        formattedContent, 
        advancedSettings.headerDisclaimer,
        advancedSettings.authorName
      );
      formattedContent = headerResult.content;
      appliedRules.push(headerResult.rule);
    }
    
    // 2. è™•ç†çµå°¾æŠ¼è¨» - åŸºæ–¼ footerDisclaimer åƒæ•¸
    if (advancedSettings.footerDisclaimer !== 'none') {
      const footerResult = await this.applyFooterDisclaimer(
        formattedContent,
        advancedSettings.footerDisclaimer
      );
      formattedContent = footerResult.content;
      appliedRules.push(footerResult.rule);
    }
    
    // 3. æ‡‰ç”¨å…¶ä»–æ ¼å¼è™•ç†ï¼ˆDropcapã€é—œè¯æ–‡ç« ç­‰ï¼‰
    formattedContent = await this.applyOtherFormatting(
      formattedContent, 
      analysisResult
    );
    
    return {
      formattedContent,
      appliedSettings: advancedSettings,
      metadata: {
        hasHeaderDisclaimer: advancedSettings.headerDisclaimer !== 'none',
        hasFooterDisclaimer: advancedSettings.footerDisclaimer !== 'none',
        authorName: advancedSettings.authorName,
        appliedRules,
        processingTime: Date.now()
      }
    };
  }
  
  /**
   * æ‡‰ç”¨é–‹é ­æŠ¼è¨» - åƒæ•¸é©…å‹•
   */
  private async applyHeaderDisclaimer(
    content: string, 
    disclaimerType: DisclaimerType,
    authorName?: string
  ): Promise<{content: string, rule: string}> {
    
    const template = DisclaimerTemplates[disclaimerType]?.header;
    if (!template) {
      return { content, rule: `è·³éé–‹é ­æŠ¼è¨»ï¼šæœªæ‰¾åˆ° ${disclaimerType} æ¨¡æ¿` };
    }
    
    let disclaimer = template;
    if (authorName && template.includes('ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½')) {
      disclaimer = template.replace(/ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½/g, authorName);
    }
    
    // æ’å…¥é‚è¼¯ï¼šåœ¨å¼•è¨€å€å¡Šå¾Œã€ç¬¬ä¸€å€‹åˆ†éš”ç·šå‰
    const insertedContent = this.insertHeaderDisclaimer(content, disclaimer);
    
    return {
      content: insertedContent,
      rule: `æ‡‰ç”¨é–‹é ­æŠ¼è¨»ï¼š${disclaimerType}${authorName ? ` (ä¾›ç¨¿æ–¹: ${authorName})` : ''}`
    };
  }
  
  /**
   * æ‡‰ç”¨çµå°¾æŠ¼è¨» - åƒæ•¸é©…å‹•
   */
  private async applyFooterDisclaimer(
    content: string,
    disclaimerType: DisclaimerType
  ): Promise<{content: string, rule: string}> {
    
    const template = DisclaimerTemplates[disclaimerType]?.footer;
    if (!template) {
      return { content, rule: `è·³éçµå°¾æŠ¼è¨»ï¼š${disclaimerType} é¡å‹ç„¡çµå°¾æ¨¡æ¿` };
    }
    
    // æ’å…¥é‚è¼¯ï¼šåœ¨ TG Banner å‰æ’å…¥
    const insertedContent = this.insertFooterDisclaimer(content, template);
    
    return {
      content: insertedContent,
      rule: `æ‡‰ç”¨çµå°¾æŠ¼è¨»ï¼š${disclaimerType}`
    };
  }
  
  /**
   * é©—è­‰åƒæ•¸åˆæ³•æ€§
   */
  validateSettings(settings: AdvancedArticleSettings): string[] {
    const warnings: string[] = [];
    
    // æª¢æŸ¥æŠ¼è¨»åƒæ•¸åˆæ³•æ€§
    if (!['none', 'sponsored', 'press-release'].includes(settings.headerDisclaimer)) {
      warnings.push(`ç„¡æ•ˆçš„é–‹é ­æŠ¼è¨»é¡å‹ï¼š${settings.headerDisclaimer}`);
    }
    
    if (!['none', 'sponsored', 'press-release'].includes(settings.footerDisclaimer)) {
      warnings.push(`ç„¡æ•ˆçš„çµå°¾æŠ¼è¨»é¡å‹ï¼š${settings.footerDisclaimer}`);
    }
    
    // æª¢æŸ¥é‚è¼¯åˆç†æ€§
    if (settings.headerDisclaimer !== 'none' && !settings.authorName) {
      warnings.push('è¨­å®šæŠ¼è¨»æ™‚å»ºè­°å¡«å¯«ä¾›ç¨¿æ–¹åç¨±ï¼Œå¦å‰‡å°‡é¡¯ç¤ºä½”ä½ç¬¦');
    }
    
    if (settings.headerDisclaimer === 'sponsored' && settings.footerDisclaimer === 'none') {
      warnings.push('å»£ç·¨ç¨¿é€šå¸¸å»ºè­°åŒ…å«çµå°¾å…è²¬è²æ˜ä»¥ç¬¦åˆæ³•è¦è¦æ±‚');
    }
    
    return warnings;
  }
}
```

#### Enhanced CopyEditorAgent - å°ˆæ³¨å…§å®¹åˆ†æ
```typescript
class EnhancedCopyEditorAgent {
  /**
   * æ ¸å¿ƒåˆ†æåŠŸèƒ½ - ä¸è™•ç†æ ¼å¼æ¨¡æ¿
   */
  async analyzeContent(
    content: string, 
    articleClassification: ArticleClassification
  ): Promise<EnhancedCopyEditingResult> {
    
    // 1. åŸºç¤WordPressåƒæ•¸æå–
    const basicParams = await this.extractBasicParams(content);
    
    // 2. æ™ºèƒ½å…§å®¹åˆ†æ
    const contentAnalysis = await this.analyzeContentIntelligently(content);
    
    // 3. é—œè¯æ–‡ç« æœå°‹
    const relatedArticles = await this.searchRelatedArticles(content);
    
    // 4. æ’°ç¨¿æ–¹è³‡è¨Šè­˜åˆ¥
    const authorInfo = await this.identifyAuthorInfo(content);
    
    // æ³¨æ„ï¼šä¸è™•ç†ä»»ä½•æ ¼å¼æ¨¡æ¿ï¼Œåªåˆ†æå’Œæå–è³‡è¨Š
    return {
      wordpress_params: basicParams,
      article_classification: articleClassification,
      content_analysis: contentAnalysis,
      related_articles: relatedArticles,
      author_info: authorInfo
    };
  }
  
  /**
   * æ™ºèƒ½å…§å®¹åˆ†æ - AIæ“…é•·çš„ä»»å‹™
   */
  private async analyzeContentIntelligently(content: string): Promise<ContentAnalysis> {
    return {
      // ä¸­æ–‡ç”¨èªè‡ªå‹•è½‰æ›
      chinese_terminology_fixes: await this.fixChineseTerminology(content),
      
      // æ™ºèƒ½slugç”Ÿæˆ
      suggested_slug: await this.generateEnglishSlug(content),
      
      // æ‘˜è¦ç”Ÿæˆ
      excerpt: await this.generateExcerpt(content),
      
      // é–±è®€æ™‚é–“ä¼°ç®—
      estimated_reading_time: this.calculateReadingTime(content),
      
      // æ’°ç¨¿æ–¹åç¨±è­˜åˆ¥
      author_name: await this.extractAuthorName(content)
    };
  }
  
  /**
   * é—œè¯æ–‡ç« æœå°‹ - AIæ“…é•·çš„ä»»å‹™
   */
  private async searchRelatedArticles(content: string): Promise<RelatedArticles> {
    // ä½¿ç”¨AIåˆ†æå…§å®¹ä¸»é¡Œï¼Œæœå°‹BlockTempoç›¸é—œæ–‡ç« 
    const keywords = await this.extractKeywords(content);
    
    return {
      background: await this.searchBlockTempoArticles(keywords, 'background'),
      previous_context: await this.searchBlockTempoArticles(keywords, 'context'),
      related_reading: await this.searchBlockTempoArticles(keywords, 'reading')
    };
  }
}
```

### 4.3 è¨­å®šæª”ç®¡ç†é‡æ§‹

#### åƒæ•¸é©…å‹•çš„æ¨¡æ¿é…ç½®
```typescript
// src/config/parameter-driven-templates.ts

/**
 * æŠ¼è¨»æ¨¡æ¿åº« - æ”¯æ´åƒæ•¸åŒ–å’Œæ“´å±•
 */
export const DisclaimerTemplates: Record<DisclaimerType, DisclaimerTemplate> = {
  none: {
    name: 'ä¸æŠ¼è¨»',
    description: 'ç´”å…§å®¹ï¼Œä¸æ·»åŠ ä»»ä½•æŠ¼è¨»',
    header: null,
    footer: null,
    authorPlaceholder: null,
    useCases: ['ä¸€èˆ¬æ–‡ç« ', 'å…§éƒ¨æ–‡ç« ', 'ç´”æŠ€è¡“å…§å®¹']
  },
  
  sponsored: {
    name: 'å»£ç·¨ç¨¿æŠ¼è¨»',
    description: 'å®Œæ•´çš„å»£ç·¨ç¨¿å…è²¬è²æ˜',
    header: '<span style="color: #808080;"><em>æœ¬æ–‡ç‚ºå»£ç·¨ç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ï¼Œäº¦éæŠ•è³‡å»ºè­°ã€è³¼è²·æˆ–å‡ºå”®å»ºè­°ã€‚è©³è¦‹æ–‡æœ«è²¬ä»»è­¦ç¤ºã€‚</em></span>',
    footer: '<div class="alert alert-warning">å»£ç·¨å…è²¬è²æ˜ï¼šæœ¬æ–‡å…§å®¹ç‚ºä¾›ç¨¿è€…æä¾›ä¹‹å»£å®£ç¨¿ä»¶ï¼Œä¾›ç¨¿è€…èˆ‡å‹•å€ä¸¦ç„¡ä»»ä½•é—œä¿‚ï¼Œæœ¬æ–‡äº¦ä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚æœ¬æ–‡ç„¡æ„æä¾›ä»»ä½•æŠ•è³‡ã€è³‡ç”¢å»ºè­°æˆ–æ³•å¾‹æ„è¦‹ï¼Œä¹Ÿä¸æ‡‰è¢«è¦–ç‚ºè³¼è²·ã€å‡ºå”®æˆ–æŒæœ‰è³‡ç”¢çš„è¦ç´„ã€‚å»£å®£ç¨¿ä»¶å…§å®¹æ‰€æåŠä¹‹ä»»ä½•æœå‹™ã€æ–¹æ¡ˆæˆ–å·¥å…·ç­‰åƒ…ä¾›åƒè€ƒï¼Œä¸”æœ€çµ‚å¯¦éš›å…§å®¹æˆ–è¦å‰‡ä»¥ä¾›ç¨¿æ–¹ä¹‹å…¬å¸ƒæˆ–èªªæ˜ç‚ºæº–ï¼Œå‹•å€ä¸å°ä»»ä½•å¯èƒ½å­˜åœ¨ä¹‹é¢¨éšªæˆ–æå¤±è² è²¬ï¼Œæé†’è®€è€…é€²è¡Œä»»ä½•æ±ºç­–æˆ–è¡Œç‚ºå‰å‹™å¿…è‡ªè¡Œè¬¹æ…æŸ¥æ ¸ã€‚</div>',
    authorPlaceholder: 'ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½',
    useCases: ['è´ŠåŠ©å…§å®¹', 'åˆä½œæ–‡ç« ', 'å•†æ¥­æ¨å»£']
  },
  
  'press-release': {
    name: 'æ–°èç¨¿æŠ¼è¨»',
    description: 'ç°¡åŒ–çš„æ–°èç¨¿è²æ˜',
    header: '<span style="color: #808080;"><em>æœ¬æ–‡ç‚ºæ–°èç¨¿ï¼Œç”±ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½ æ’°æ–‡ã€æä¾›ï¼Œä¸ä»£è¡¨å‹•å€ç«‹å ´ã€‚</em></span>',
    footer: null,
    authorPlaceholder: 'ï¼»æ’°ç¨¿æ–¹åç¨±ï¼½',
    useCases: ['ä¼æ¥­æ–°èç¨¿', 'ç”¢å“ç™¼ä½ˆ', 'å®˜æ–¹è²æ˜']
  }
};

/**
 * æ–‡ç¨¿é¡å‹é è¨­é…ç½® - åƒ…ä½œç‚ºä¾¿åˆ©æ€§é è¨­å€¼
 */
export const ArticleTypeDefaults: Record<ArticleType, AdvancedArticleSettings> = {
  regular: {
    headerDisclaimer: 'none',
    footerDisclaimer: 'none',
    authorName: undefined
  },
  sponsored: {
    headerDisclaimer: 'sponsored',
    footerDisclaimer: 'sponsored', 
    authorName: undefined
  },
  'press-release': {
    headerDisclaimer: 'press-release',
    footerDisclaimer: 'none',
    authorName: undefined
  }
};

/**
 * åƒæ•¸çµ„åˆé©—è­‰è¦å‰‡
 */
export const SettingsValidationRules = {
  // æ¨è–¦çš„åƒæ•¸çµ„åˆ
  recommendedCombinations: [
    {
      name: 'æ¨™æº–å»£ç·¨ç¨¿',
      settings: { headerDisclaimer: 'sponsored', footerDisclaimer: 'sponsored' },
      description: 'å®Œæ•´çš„å»£ç·¨ç¨¿æ ¼å¼ï¼ŒåŒ…å«é–‹é ­å’Œçµå°¾æŠ¼è¨»'
    },
    {
      name: 'ç°¡åŒ–å»£ç·¨ç¨¿', 
      settings: { headerDisclaimer: 'sponsored', footerDisclaimer: 'none' },
      description: 'åƒ…é–‹é ­æŠ¼è¨»çš„å»£ç·¨ç¨¿ï¼Œé©åˆç°¡çŸ­å…§å®¹'
    },
    {
      name: 'æ¨™æº–æ–°èç¨¿',
      settings: { headerDisclaimer: 'press-release', footerDisclaimer: 'none' },
      description: 'æ¨™æº–æ–°èç¨¿æ ¼å¼ï¼Œåƒ…é–‹é ­æŠ¼è¨»'
    },
    {
      name: 'ç´”å…§å®¹',
      settings: { headerDisclaimer: 'none', footerDisclaimer: 'none' },
      description: 'ç„¡æŠ¼è¨»çš„ç´”å…§å®¹æ ¼å¼'
    }
  ],
  
  // è­¦å‘Šè¦å‰‡
  warningRules: [
    {
      condition: (s: AdvancedArticleSettings) => s.headerDisclaimer === 'sponsored' && s.footerDisclaimer === 'none',
      warning: 'å»£ç·¨ç¨¿é€šå¸¸å»ºè­°åŒ…å«çµå°¾å…è²¬è²æ˜ä»¥ç¬¦åˆæ³•è¦è¦æ±‚'
    },
    {
      condition: (s: AdvancedArticleSettings) => (s.headerDisclaimer !== 'none' || s.footerDisclaimer !== 'none') && !s.authorName,
      warning: 'è¨­å®šæŠ¼è¨»æ™‚å»ºè­°å¡«å¯«ä¾›ç¨¿æ–¹åç¨±ï¼Œå¦å‰‡å°‡é¡¯ç¤ºä½”ä½ç¬¦'
    }
  ]
};
```

### 4.4 APIè¨­è¨ˆæ›´æ–°

#### è™•ç†æµç¨‹API
```typescript
// API: /api/process-article (åƒæ•¸é©…å‹•ç‰ˆæœ¬)
interface ProcessArticleRequest {
  content: string;
  advancedSettings: AdvancedArticleSettings; // æ ¸å¿ƒï¼šåŸºæ–¼åƒæ•¸è€Œéé¡å‹
  articleType?: ArticleType; // å¯é¸ï¼šåƒ…ç”¨æ–¼è¨˜éŒ„å’Œçµ±è¨ˆ
  mode: 'auto' | 'manual';
}

interface ProcessArticleResponse {
  success: boolean;
  data: {
    formattedContent: string;
    appliedSettings: AdvancedArticleSettings;
    appliedRules: string[];
    wordpress_params: WordPressPublishData;
    warnings: string[];
  };
  metadata: {
    processingTime: number;
    hasHeaderDisclaimer: boolean;
    hasFooterDisclaimer: boolean;
    authorName?: string;
  };
}
```

### 4.5 ç”¨æˆ¶é«”é©—å„ªåŒ–

#### è¨­å®šé è¦½å’Œé©—è­‰
```typescript
const SettingsPreview = ({ settings }: { settings: AdvancedArticleSettings }) => {
  const warnings = validateSettings(settings);
  const preview = generateSettingsPreview(settings);
  
  return (
    <div className="settings-preview">
      <h4>è¨­å®šé è¦½</h4>
      <div className="preview-content">
        {preview.headerDisclaimer && (
          <div className="preview-header">
            <strong>é–‹é ­æŠ¼è¨»ï¼š</strong>
            <div dangerouslySetInnerHTML={{ __html: preview.headerDisclaimer }} />
          </div>
        )}
        
        {preview.footerDisclaimer && (
          <div className="preview-footer">
            <strong>çµå°¾æŠ¼è¨»ï¼š</strong>
            <div dangerouslySetInnerHTML={{ __html: preview.footerDisclaimer }} />
          </div>
        )}
        
        {!preview.headerDisclaimer && !preview.footerDisclaimer && (
          <div className="preview-none">
            <em>ç´”å…§å®¹æ ¼å¼ï¼Œç„¡æŠ¼è¨»</em>
          </div>
        )}
      </div>
      
      {warnings.length > 0 && (
        <div className="warnings">
          <h5>å»ºè­°ï¼š</h5>
          <ul>
            {warnings.map((warning, index) => (
              <li key={index} className="warning-item">{warning}</li>
            ))}
          </ul>
        </div>
      )}
    </div>
  );
};
```

## 8. ArticleFormattingProcessor åŠŸèƒ½ç¯„åœé™åˆ¶èˆ‡ä¿®æ­£è¨˜éŒ„

### 8.1 å•é¡ŒèƒŒæ™¯
åœ¨åˆå§‹å¯¦ç¾ä¸­ï¼ŒArticleFormattingProcessor éŒ¯èª¤åœ°é‡è¤‡å¯¦ç¾äº†å¤šå€‹æ‡‰è©²åœ¨å‰é¢ AI Agent éšæ®µå®Œæˆçš„åŠŸèƒ½ï¼Œå°è‡´è™•ç†æµç¨‹æ··äº‚å’ŒåŠŸèƒ½é‡è¤‡ã€‚

### 8.2 å·²åˆªé™¤çš„éŒ¯èª¤åŠŸèƒ½
ä»¥ä¸‹åŠŸèƒ½å·²å¾ ArticleFormattingProcessor ä¸­å®Œå…¨ç§»é™¤ï¼Œå› ç‚ºå®ƒå€‘æ‡‰è©²åœ¨å‰é¢çš„ AI Agent éšæ®µè™•ç†ï¼š

1. **ç§»é™¤ç™¼å¸ƒè§£ç¦æ•˜è¿°** (`removeEmbargoStatements`)
   - åŸå› ï¼šæ‡‰è©²åœ¨å‰é¢çš„ AI Agent éšæ®µå®Œæˆ
   - åˆªé™¤æ–¹æ³•ï¼šå®Œå…¨ç§»é™¤ç›¸é—œä»£ç¢¼å’Œé‚è¼¯

2. **ä¸­æ–‡ç”¨èªè½‰æ›** (`applyChineseTerminologyConversion`)
   - åŸå› ï¼šæ‡‰è©²åœ¨å‰é¢çš„ AI Agent éšæ®µå®Œæˆ
   - åˆªé™¤æ–¹æ³•ï¼šå®Œå…¨ç§»é™¤ terminologyMap å’Œè½‰æ›é‚è¼¯

3. **è‹±æ–‡å’Œæ•¸å­—å‰å¾Œç©ºæ ¼è™•ç†** (`addSpacesAroundEnglishAndNumbers`)
   - åŸå› ï¼šæ‡‰è©²åœ¨å‰é¢çš„ AI Agent éšæ®µå®Œæˆ
   - åˆªé™¤æ–¹æ³•ï¼šå®Œå…¨ç§»é™¤ç©ºæ ¼æ·»åŠ é‚è¼¯

4. **ç”Ÿæˆè‹±æ–‡æ°¸ä¹…é€£çµ** (`generateEnglishSlug` å’Œ `translateToEnglish`)
   - åŸå› ï¼šæ‡‰è©²åœ¨å‰é¢çš„ AI Agent éšæ®µå®Œæˆ
   - åˆªé™¤æ–¹æ³•ï¼šå®Œå…¨ç§»é™¤ç›¸é—œéœæ…‹æ–¹æ³•

### 8.3 ä¿®æ­£çš„åŠŸèƒ½
**æ¨™é¡Œå±¤ç´šæ­£è¦åŒ–** (`normalizeHeadings`)
- **ä¿®æ­£å‰**ï¼šå°‡ h1, h2 è½‰ç‚º h3ï¼›å°‡ h5, h6 è½‰ç‚º h4
- **ä¿®æ­£å¾Œ**ï¼šä¿æŒ h1 ä¸è®Šï¼Œåªé€²è¡Œ h2â†’h3, h3â†’h4, h4â†’h5 çš„è½‰æ›
- **ä¿®æ­£åŸå› **ï¼šé¿å…å½±éŸ¿æ–‡ç« ä¸»æ¨™é¡Œçµæ§‹

### 8.4 ArticleFormattingProcessor ç•¶å‰è·è²¬ç¯„åœ
ç¶“éä¿®æ­£å¾Œï¼ŒArticleFormattingProcessor ç¾åœ¨åªè² è²¬ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

1. **åƒæ•¸é©…å‹•çš„æ¨¡æ¿æ‡‰ç”¨** - åŸºæ–¼ç”¨æˆ¶è¨­å®šçš„ AdvancedArticleSettings é€²è¡Œæ ¼å¼åŒ–
2. **æŠ¼è¨»æ¨¡æ¿æ’å…¥** - æ ¹æ“š headerDisclaimer å’Œ footerDisclaimer åƒæ•¸æ’å…¥å°æ‡‰æ¨¡æ¿
3. **Dropcap æ ¼å¼æ‡‰ç”¨** - ç‚ºæ–‡ç« é¦–æ®µç¬¬ä¸€å€‹å­—ç¬¦æ‡‰ç”¨ Dropcap æ¨£å¼
4. **æ¨™é¡Œå±¤ç´šæ­£è¦åŒ–** - åƒ…èª¿æ•´ h2-h4 æ¨™é¡Œå±¤ç´šï¼Œä¸å‹• h1
5. **å¼•è¨€å€å¡Šè™•ç†** - æ‡‰ç”¨ intro_quote æ¨£å¼å’Œé—œè¯æ–‡ç« é€£çµ
6. **ç›¸é—œé–±è®€å€å¡Šæ’å…¥** - æ·»åŠ  TG Banner å’Œç›¸é—œæ–‡ç« é€£çµ

## 9. æŠ€è¡“å¯¦ç¾å•é¡Œä¿®å¾©è¨˜éŒ„

### 9.1 æ–‡ç¨¿åˆ†é¡åˆå§‹åŒ–å•é¡Œ
**å•é¡Œæè¿°**ï¼šçµ„ä»¶åˆå§‹åŒ–æ™‚è¨­ç½®äº†é è¨­æ–‡ç¨¿åˆ†é¡å€¼ï¼Œä½†æ²’æœ‰èª¿ç”¨ `setArticleClassification`ï¼Œå°è‡´ ProcessingContext ä¸­çš„æ–‡ç¨¿åˆ†é¡ç‚º undefinedã€‚

**éŒ¯èª¤è¨Šæ¯**ï¼š`ç¼ºå°‘æ–‡ç¨¿åˆ†é¡æˆ–é€²éšè¨­å®šï¼Œç„¡æ³•é€²è¡Œæ ¼å¼åŒ–è™•ç†`

**è§£æ±ºæ–¹æ¡ˆ**ï¼šåœ¨ IntegratedFileProcessor ä¸­æ·»åŠ  useEffect ä¾†åˆå§‹åŒ–æ–‡ç¨¿åˆ†é¡ï¼š
```typescript
// åˆå§‹åŒ–æ–‡ç¨¿åˆ†é¡è¨­å®š
useEffect(() => {
  const template = getArticleTemplate(selectedArticleType);
  const classification: ArticleClassification = {
    articleType: selectedArticleType,
    author: template.author as 'BTEditor' | 'BTVerse' | 'custom',
    authorDisplayName: template.authorDisplayName || undefined,
    authorId: template.authorId,
    requiresAdTemplate: selectedArticleType === 'sponsored',
    templateVersion: 'v1.0',
    timestamp: Date.now(),
    advancedSettings
  };
  
  setArticleClassification(classification);
}, []); // åªåœ¨çµ„ä»¶åˆå§‹åŒ–æ™‚åŸ·è¡Œä¸€æ¬¡
```

### 9.2 UI éšæ®µé¡¯ç¤ºä¸å®Œæ•´å•é¡Œ
**å•é¡Œæè¿°**ï¼šé›–ç„¶ ProcessingContext ä¸­å®šç¾©äº† `article-formatting` éšæ®µï¼Œä½† UI ä¸Šæ²’æœ‰é¡¯ç¤ºè©²éšæ®µã€‚

**æ ¹æœ¬åŸå› **ï¼šIntegratedFileProcessor ä¸­çš„ stageGroups å®šç¾©èˆ‡ ProcessingContext ä¸ä¸€è‡´ï¼š
- ProcessingContextï¼š`['advanced-ai', 'format-conversion', 'copy-editing', 'article-formatting']`
- IntegratedFileProcessorï¼š`['advanced-ai', 'format-conversion', 'copy-editing']` âŒ

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
1. ä¿®æ­£ IntegratedFileProcessor ä¸­çš„ stageGroups å®šç¾©ï¼Œç¢ºä¿åŒ…å« `article-formatting`
2. åœ¨ `getStageTitle` å‡½æ•¸ä¸­æ·»åŠ ç¼ºå¤±çš„éšæ®µæ¨™é¡Œæ˜ å°„
3. åœ¨ `formatStageResult` å‡½æ•¸ä¸­æ·»åŠ å° `article-formatting` éšæ®µçš„æ”¯æŒ
4. åœ¨ `getStageViewerUrl` å‡½æ•¸ä¸­æ·»åŠ å° `article-formatting` éšæ®µçš„æŸ¥çœ‹æ”¯æŒ

### 9.3 é˜²æ­¢å†æ¬¡å‡ºéŒ¯çš„æª¢æŸ¥æ¸…å–®
åœ¨ä¿®æ”¹è™•ç†æµç¨‹æ™‚ï¼Œè«‹ç¢ºä¿ä»¥ä¸‹ä¸€è‡´æ€§ï¼š

1. **éšæ®µå®šç¾©ä¸€è‡´æ€§**ï¼š
   - ProcessingContext.tsx ä¸­çš„ `defaultStages`
   - ProcessingContext.tsx ä¸­çš„ `stageGroups`
   - IntegratedFileProcessor.tsx ä¸­çš„ ProgressDisplay `stageGroups`
   - å„éšæ®µè™•ç†å™¨çš„ Hook ä¸­çš„éšæ®µ ID

2. **éšæ®µæ¨™é¡Œæ˜ å°„å®Œæ•´æ€§**ï¼š
   - IntegratedFileProcessor.tsx ä¸­çš„ `getStageTitle` å‡½æ•¸
   - ç¢ºä¿æ‰€æœ‰éšæ®µéƒ½æœ‰å°æ‡‰çš„ä¸­æ–‡é¡¯ç¤ºåç¨±

3. **éšæ®µçµæœè™•ç†å®Œæ•´æ€§**ï¼š
   - `formatStageResult` å‡½æ•¸æ”¯æ´æ‰€æœ‰éšæ®µçš„çµæœæ ¼å¼
   - `getStageViewerUrl` å‡½æ•¸æ”¯æ´æ‰€æœ‰å¯æŸ¥çœ‹éšæ®µçš„ URL ç”Ÿæˆ

4. **æ–‡ç¨¿åˆ†é¡åˆå§‹åŒ–**ï¼š
   - ç¢ºä¿çµ„ä»¶åˆå§‹åŒ–æ™‚æ­£ç¢ºèª¿ç”¨ `setArticleClassification`
   - ç¢ºä¿ `getArticleClassification` èƒ½è¿”å›æœ‰æ•ˆçš„åˆ†é¡æ•¸æ“š

### 9.4 ä¿®å¾©ç¢ºèª
âœ… æ–‡ç¨¿åˆ†é¡åˆå§‹åŒ–å•é¡Œå·²ä¿®å¾©
âœ… UI éšæ®µé¡¯ç¤ºå•é¡Œå·²ä¿®å¾©  
âœ… éšæ®µæ¨™é¡Œæ˜ å°„å•é¡Œå·²ä¿®å¾©
âœ… éšæ®µçµæœæŸ¥çœ‹åŠŸèƒ½å·²å®Œå–„
âœ… æ¨™é¡Œå±¤ç´šæ­£è¦åŒ–é€£é–æ›¿æ›å•é¡Œå·²ä¿®å¾©
âœ… é–‹é ­æŠ¼è¨»ä½ç½®éŒ¯èª¤å·²ä¿®å¾©
âœ… Article Formatting å…­å¤§æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆ
âœ… è¨­è¨ˆæ–‡æª”å·²æ›´æ–°è¨˜éŒ„ä¿®å¾©å…§å®¹

### 9.5 æ¨™é¡Œå±¤ç´šæ­£è¦åŒ–é€£é–æ›¿æ›å•é¡Œä¿®å¾©
**å•é¡Œæè¿°**ï¼šç”¨æˆ¶åæ˜ é€²éšæ ¼å¼åŒ–è½‰æ›å¾Œï¼Œh2æˆ–h3æ¨™é¡Œè®Šæˆh5æˆ–ä¸Ÿå¤±æ¨™é¡Œæ ¼å¼ã€‚

**æ ¹æœ¬åŸå› åˆ†æ**ï¼š
`normalizeHeadings` æ–¹æ³•å­˜åœ¨é€£é–æ›¿æ›å•é¡Œï¼ŒåŸå§‹é‚è¼¯æŒ‰ä»¥ä¸‹é †åºé€²è¡Œï¼š
```typescript
// âŒ éŒ¯èª¤çš„æ›¿æ›é †åºï¼ˆå¾ä½åˆ°é«˜ï¼‰
normalized = normalized.replace(/<h2([^>]*)>/gi, '<h3$1>');  // h2 â†’ h3
normalized = normalized.replace(/<h3([^>]*)>/gi, '<h4$1>');  // h3 â†’ h4 (åŒ…æ‹¬å‰›è½‰æ›çš„h3)
normalized = normalized.replace(/<h4([^>]*)>/gi, '<h5$1>');  // h4 â†’ h5 (åŒ…æ‹¬å‰›è½‰æ›çš„h4)
```

**é€£é–æ›¿æ›å½±éŸ¿**ï¼š
- h2 â†’ h3ï¼ˆç¬¬ä¸€æ­¥ï¼‰
- å‰›è½‰æ›çš„ h3 â†’ h4ï¼ˆç¬¬äºŒæ­¥ï¼‰
- å‰›è½‰æ›çš„ h4 â†’ h5ï¼ˆç¬¬ä¸‰æ­¥ï¼‰
- **çµæœ**ï¼šh2 æœ€çµ‚è®Šæˆ h5ï¼ˆä¸‹é™3ç´šï¼‰ï¼Œh3 è®Šæˆ h5ï¼ˆä¸‹é™2ç´šï¼‰

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
æ”¹ç‚ºå¾é«˜å±¤ç´šå¾€ä½å±¤ç´šé€²è¡Œæ›¿æ›ï¼Œé¿å…å½±éŸ¿å·²è™•ç†çš„æ¨™ç±¤ï¼š
```typescript
// âœ… æ­£ç¢ºçš„æ›¿æ›é †åºï¼ˆå¾é«˜åˆ°ä½ï¼‰
// å…ˆè™•ç† h4 â†’ h5
normalized = normalized.replace(/<h4([^>]*)>/gi, '<h5$1>');
normalized = normalized.replace(/<\/h4>/gi, '</h5>');

// å†è™•ç† h3 â†’ h4  
normalized = normalized.replace(/<h3([^>]*)>/gi, '<h4$1>');
normalized = normalized.replace(/<\/h3>/gi, '</h4>');

// æœ€å¾Œè™•ç† h2 â†’ h3
normalized = normalized.replace(/<h2([^>]*)>/gi, '<h3$1>');
normalized = normalized.replace(/<\/h2>/gi, '</h3>');
```

**ä¿®å¾©çµæœ**ï¼š
- h2 â†’ h3ï¼ˆåªä¸‹é™1ç´šï¼‰âœ…
- h3 â†’ h4ï¼ˆåªä¸‹é™1ç´šï¼‰âœ… 
- h4 â†’ h5ï¼ˆåªä¸‹é™1ç´šï¼‰âœ…
- h1 ä¿æŒä¸è®Š âœ…

**å­¸ç¿’åˆ°çš„æ•™è¨“**ï¼š
1. **å­—ç¬¦ä¸²æ›¿æ›é †åºå¾ˆé‡è¦**ï¼šåœ¨é€²è¡Œå¤šæ­¥é©Ÿå­—ç¬¦ä¸²æ›¿æ›æ™‚ï¼Œå¿…é ˆè€ƒæ…®æ›¿æ›çš„é †åºï¼Œé¿å…å‰é¢çš„æ›¿æ›å½±éŸ¿å¾Œé¢çš„é‚è¼¯
2. **æ­£å‰‡è¡¨é”å¼è¦å…¨é¢æ¸¬è©¦**ï¼šç‰¹åˆ¥æ˜¯æ¶‰åŠHTMLæ¨™ç±¤è™•ç†çš„æ­£å‰‡è¡¨é”å¼ï¼Œéœ€è¦æ¸¬è©¦å„ç¨®æ¨™ç±¤çµ„åˆå’ŒåµŒå¥—æƒ…æ³
3. **è¦æœ‰æ˜ç¢ºçš„è™•ç†ç›®æ¨™**ï¼šæ¨™é¡Œæ­£è¦åŒ–çš„ç›®æ¨™æ˜¯è®“æ¯å€‹æ¨™é¡Œåªä¸‹é™1ç´šï¼Œè€Œä¸æ˜¯é€£çºŒè™•ç†
4. **ä»£ç¢¼è¨»é‡‹è¦æ˜ç¢ºè­¦ç¤º**ï¼šå°æ–¼å®¹æ˜“å‡ºéŒ¯çš„é‚è¼¯ï¼Œè¦æ·»åŠ è©³ç´°è¨»é‡‹èªªæ˜æ­£ç¢ºçš„è™•ç†é †åº

**é˜²éŒ¯æª¢æŸ¥æ¸…å–®**ï¼š
â–¡ å¤šæ­¥é©Ÿå­—ç¬¦ä¸²æ›¿æ›å¿…é ˆå¾é«˜å±¤ç´šå¾€ä½å±¤ç´šé€²è¡Œ
â–¡ æ¯å€‹æ›¿æ›æ­¥é©Ÿåªå½±éŸ¿ç›®æ¨™å±¤ç´šï¼Œä¸å½±éŸ¿å·²è™•ç†çš„å±¤ç´š  
â–¡ æ·»åŠ è©³ç´°è¨»é‡‹èªªæ˜æ›¿æ›é †åºçš„é‡è¦æ€§
â–¡ æ¸¬è©¦é‚Šç•Œæƒ…æ³ï¼ˆå¦‚é€£çºŒçš„åŒç´šæ¨™é¡Œï¼‰

### 9.6 é–‹é ­æŠ¼è¨»ä½ç½®éŒ¯èª¤ä¿®å¾©
**å•é¡Œæè¿°**ï¼šç”¨æˆ¶åæ˜ æ­£æ–‡é–‹é ­æŠ¼è¨»ä¸¦æ²’æœ‰å‡ºç¾åœ¨æ­£æ–‡é–‹é ­çš„æ­£ç¢ºä½ç½®ï¼Œè€Œæ˜¯å‡ºç¾åœ¨æ­£æ–‡å°¾ç«¯ã€æœ«å°¾æŠ¼è¨»ä¹‹å‰ã€‚

**æ ¹æœ¬åŸå› åˆ†æ**ï¼š
åœ¨ `applyHeaderDisclaimer` æ–¹æ³•ä¸­ï¼Œé–‹é ­æŠ¼è¨»è¢«éŒ¯èª¤åœ°åŠ åˆ°å…§å®¹çš„æœ«å°¾ï¼š
```typescript
// âŒ éŒ¯èª¤çš„æ’å…¥é‚è¼¯
const disclaimerWithSeparator = `${disclaimer}\n\n<hr />`;
const insertedContent = content + '\n\n' + disclaimerWithSeparator;  // åŠ åˆ°æœ«å°¾
```

**éŒ¯èª¤çš„è™•ç†é †åº**ï¼š
1. å¼•è¨€å€å¡Š
2. æ­£æ–‡å…§å®¹  
3. é–‹é ­æŠ¼è¨»ï¼ˆâŒ éŒ¯èª¤åœ°æ”¾åœ¨é€™è£¡ï¼‰
4. çµå°¾æŠ¼è¨»

**æ­£ç¢ºçš„è™•ç†é †åºæ‡‰è©²æ˜¯**ï¼š
1. å¼•è¨€å€å¡Š
2. é–‹é ­æŠ¼è¨»ï¼ˆâœ… æ‡‰è©²åœ¨é€™è£¡ï¼‰
3. æ­£æ–‡å…§å®¹
4. çµå°¾æŠ¼è¨»

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
ä¿®æ”¹æ’å…¥é‚è¼¯ï¼Œæ™ºèƒ½å°‹æ‰¾å¼•è¨€å€å¡Šçš„çµæŸä½ç½®ï¼Œä¸¦åœ¨å…¶å¾Œæ­£ç¢ºæ’å…¥é–‹é ­æŠ¼è¨»ï¼š
```typescript
// âœ… æ­£ç¢ºçš„æ’å…¥é‚è¼¯
const disclaimerBlock = disclaimer;  // ç§»é™¤åˆ†éš”ç·š

// å°‹æ‰¾å¼•è¨€å€å¡Šçš„çµæŸä½ç½®
const introQuoteMatch = content.match(/(<p class="intro_quote">[\s\S]*?<\/p>)/);

if (introQuoteMatch) {
  // å¦‚æœæ‰¾åˆ°å¼•è¨€å€å¡Šï¼Œåœ¨å…¶å¾Œæ’å…¥æŠ¼è¨»ï¼ˆç”¨å…©å€‹bråˆ†éš”ï¼‰
  const introQuote = introQuoteMatch[1];
  const restContent = content.substring(content.indexOf(introQuote) + introQuote.length);
  const insertedContent = introQuote + '<br><br>' + disclaimerBlock + '<br><br>' + restContent.trim();
} else {
  // å¦‚æœæ²’æœ‰å¼•è¨€å€å¡Šï¼Œç›´æ¥åœ¨å…§å®¹é–‹é ­æ’å…¥æŠ¼è¨»
  const insertedContent = disclaimerBlock + '<br><br>' + content;
}
```

**é€²ä¸€æ­¥ä¿®å¾©åˆ†éš”ç·šä½ç½®**ï¼š
ç”¨æˆ¶åæ˜ åˆ†éš”ç·šä½ç½®ä¸æ­£ç¢ºï¼Œéœ€è¦é€²ä¸€æ­¥èª¿æ•´ï¼š
```typescript
// âœ… ä¿®å¾©æœ«å°¾æŠ¼è¨»ï¼Œåˆ†éš”ç·šåœ¨æŠ¼è¨»å‰
const footerWithSeparator = `\n\n<hr />\n\n${template}`;
```

**ä¿®å¾©çµæœ**ï¼š
- å¼•è¨€å€å¡Šåœ¨æœ€å‰é¢ âœ…
- ç”¨å…©å€‹ `<br>` åˆ†éš”å¼•è¨€å’Œé–‹é ­æŠ¼è¨» âœ…
- é–‹é ­æŠ¼è¨»ç·Šè·Ÿåœ¨å¼•è¨€å€å¡Šå¾Œ âœ…
- ç”¨å…©å€‹ `<br>` åˆ†éš”é–‹é ­æŠ¼è¨»å’Œæ­£æ–‡å…§å®¹ âœ…
- æ­£æ–‡å…§å®¹åœ¨æŠ¼è¨»ä¹‹å¾Œ âœ…
- `<hr />` åˆ†éš”ç·šåœ¨æœ«å°¾æŠ¼è¨»å‰ âœ…
- çµå°¾æŠ¼è¨»åœ¨æ–‡ç« æœ«å°¾ âœ…

**å­¸ç¿’åˆ°çš„æ•™è¨“**ï¼š
1. **å…§å®¹æ’å…¥è¦è€ƒæ…®ä¸Šä¸‹æ–‡**ï¼šæ’å…¥å…§å®¹æ™‚è¦åˆ†æç¾æœ‰çµæ§‹ï¼Œæ‰¾åˆ°æ­£ç¢ºçš„æ’å…¥ä½ç½®
2. **å­—ç¬¦ä¸²æ“ä½œè¦ç²¾ç¢º**ï¼šç°¡å–®çš„å­—ç¬¦ä¸²æ‹¼æ¥å¾€å¾€ä¸è¶³ä»¥è™•ç†è¤‡é›œçš„HTMLçµæ§‹
3. **æ­£å‰‡è¡¨é”å¼è¦è™•ç†æ›è¡Œ**ï¼šè™•ç†HTMLå…§å®¹æ™‚ï¼Œè¦è€ƒæ…®è·¨è¡Œçš„æƒ…æ³ï¼ˆä½¿ç”¨ `[\s\S]*?` è€Œé `.*?`ï¼‰
4. **è¦æœ‰é™ç´šç­–ç•¥**ï¼šç•¶æ‰¾ä¸åˆ°é æœŸçµæ§‹æ™‚ï¼Œè¦æœ‰å‚™é¸çš„è™•ç†æ–¹æ¡ˆ
5. **HTMLæ ¼å¼è¦ç²¾ç¢º**ï¼š`<br>` æ¨™ç±¤å’Œ `\n\n` åœ¨é¡¯ç¤ºæ•ˆæœä¸Šæœ‰å·®ç•°ï¼Œéœ€è¦æ ¹æ“šéœ€æ±‚é¸æ“‡
6. **åˆ†éš”ç·šä½ç½®è¦é‚è¼¯æ­£ç¢º**ï¼šé–‹é ­æŠ¼è¨»å¾Œä¸éœ€è¦åˆ†éš”ç·šï¼Œæœ«å°¾æŠ¼è¨»å‰æ‰éœ€è¦åˆ†éš”ç·š

**é˜²éŒ¯æª¢æŸ¥æ¸…å–®**ï¼š
â–¡ æ’å…¥å…§å®¹å‰å…ˆåˆ†æç›®æ¨™ä½ç½®çš„ä¸Šä¸‹æ–‡çµæ§‹
â–¡ ä½¿ç”¨æ­£å‰‡è¡¨é”å¼ç²¾ç¢ºå®šä½æ’å…¥é»
â–¡ è€ƒæ…®æ›è¡Œå’Œå¤šè¡Œå…§å®¹çš„è™•ç†
â–¡ æä¾›æ‰¾ä¸åˆ°é æœŸçµæ§‹æ™‚çš„é™ç´šç­–ç•¥
â–¡ æ¸¬è©¦æœ‰ç„¡å¼•è¨€å€å¡Šçš„å…©ç¨®æƒ…æ³
â–¡ ç¢ºèªHTMLæ¨™ç±¤å’Œæ›è¡Œç¬¦çš„æ­£ç¢ºä½¿ç”¨
â–¡ é©—è­‰åˆ†éš”ç·šå‡ºç¾åœ¨é‚è¼¯æ­£ç¢ºçš„ä½ç½®

### 9.7 æ¨¡æ¿é‡è¤‡å®šç¾©å•é¡Œé‡æ§‹
**å•é¡Œæè¿°**ï¼šç”¨æˆ¶ç™¼ç¾ `article-templates.ts` å’Œ `ArticleFormattingProcessor.ts` å…©å€‹æ–‡ä»¶ä¸­éƒ½æœ‰é‡è¤‡çš„æ¨¡æ¿å®šç¾©ï¼Œé€ æˆç¶­è­·å›°é›£å’Œä¸ä¸€è‡´çš„é¢¨éšªã€‚

**æ ¹æœ¬åŸå› åˆ†æ**ï¼š
ç³»çµ±ä¸­å­˜åœ¨å¤šè™•æ¨¡æ¿å®šç¾©çš„é‡è¤‡ï¼š

1. **æŠ¼è¨»æ¨¡æ¿é‡è¤‡**ï¼š
   - `article-templates.ts` ä¸­çš„ `headerDisclaimer` å’Œ `footerDisclaimer`
   - `ArticleFormattingProcessor.ts` ä¸­çš„ `getDisclaimerTemplates()`

2. **å¼•è¨€å€å¡Šé‡è¤‡**ï¼š
   - `article-templates.ts` ä¸­çš„ `introQuoteTemplate`
   - `ArticleFormattingProcessor.ts` ä¸­çš„ `buildIntroQuote()`

3. **TG Banner å’Œç›¸é—œé–±è®€é‡è¤‡**ï¼š
   - `article-templates.ts` ä¸­çš„ `tgBanner` å’Œ `relatedArticlesHeader`
   - `ArticleFormattingProcessor.ts` ä¸­çš„ç¡¬ç·¨ç¢¼HTML

4. **Dropcap æ¨£å¼é‡è¤‡**ï¼š
   - `article-templates.ts` ä¸­çš„ `dropcapStyle`
   - `ArticleFormattingProcessor.ts` ä¸­çš„ç¡¬ç·¨ç¢¼æ¨£å¼

**é€ æˆçš„å•é¡Œ**ï¼š
- âŒ **ä»£ç¢¼é‡è¤‡**ï¼šé•å DRYï¼ˆDon't Repeat Yourselfï¼‰åŸå‰‡
- âŒ **ç¶­è­·å›°é›£**ï¼šä¿®æ”¹æ™‚éœ€è¦åœ¨å…©å€‹åœ°æ–¹åŒæ­¥
- âŒ **ä¸ä¸€è‡´é¢¨éšª**ï¼šç”¨æˆ¶ä¿®æ”¹äº†ä¸€è™•ä½†å¦ä¸€è™•æœªåŒæ­¥
- âŒ **æ··æ·†æ€§**ï¼šé–‹ç™¼è€…ä¸çŸ¥é“è©²ä¿®æ”¹å“ªå€‹æ–‡ä»¶

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
é€²è¡Œæ¶æ§‹é‡æ§‹ï¼Œå°‡ `ArticleFormattingProcessor.ts` ä¿®æ”¹ç‚ºä½¿ç”¨çµ±ä¸€çš„æ¨¡æ¿é…ç½®ï¼š

```typescript
// âœ… é‡æ§‹å‰ï¼šé‡è¤‡å®šç¾©
private getDisclaimerTemplates() {
  return {
    sponsored: {
      header: '<span>...</span>', // ç¡¬ç·¨ç¢¼
      footer: '<div>...</div>'    // ç¡¬ç·¨ç¢¼
    }
  };
}

// âœ… é‡æ§‹å¾Œï¼šä½¿ç”¨çµ±ä¸€é…ç½®
import { ArticleTemplates } from '@/config/article-templates';

private getDisclaimerTemplates() {
  return {
    sponsored: {
      header: ArticleTemplates.sponsored.headerDisclaimer,
      footer: ArticleTemplates.sponsored.footerDisclaimer
    },
    'press-release': {
      header: ArticleTemplates['press-release'].headerDisclaimer,
      footer: ArticleTemplates['press-release'].footerDisclaimer
    }
  };
}
```

**é‡æ§‹ç¯„åœ**ï¼š
1. **æŠ¼è¨»æ¨¡æ¿** - ä½¿ç”¨ `ArticleTemplates.*.headerDisclaimer` å’Œ `footerDisclaimer`
2. **å¼•è¨€å€å¡Š** - ä½¿ç”¨ `ArticleTemplates.*.introQuoteTemplate` ä¸¦é€²è¡Œåƒæ•¸æ›¿æ›
3. **TG Banner** - ä½¿ç”¨ `ArticleTemplates.*.tgBanner`
4. **ç›¸é—œé–±è®€** - ä½¿ç”¨ `ArticleTemplates.*.relatedArticlesHeader` å’Œ `relatedArticleLinkTemplate`
5. **Dropcap æ¨£å¼** - ä½¿ç”¨ `ArticleTemplates.*.dropcapStyle`

**é‡æ§‹çµæœ**ï¼š
- å–®ä¸€çœŸå¯¦ä¾†æºï¼ˆSingle Source of Truthï¼‰âœ…
- ç§»é™¤æ‰€æœ‰é‡è¤‡å®šç¾© âœ…
- çµ±ä¸€åœ¨ `article-templates.ts` ç®¡ç†æ¨¡æ¿ âœ…
- åŒæ­¥ç”¨æˆ¶çš„è‡ªè¨‚ä¿®æ”¹ï¼ˆåŠ æ‹¬è™Ÿï¼‰âœ…
- ä¿æŒåŠŸèƒ½å®Œæ•´æ€§ âœ…
- çµ±ä¸€é è¨­å€¼é…ç½®ç®¡ç† âœ…

**é€²ä¸€æ­¥æ”¹é€² - é è¨­å€¼çµ±ä¸€ç®¡ç†**ï¼š
ç”¨æˆ¶ç™¼ç¾å‰æƒ…æ–‡ç« å’ŒèƒŒæ™¯æ–‡ç« çš„é è¨­å€¼éƒ½æ˜¯ç¡¬ç·¨ç¢¼çš„ï¼Œå»ºè­°çµ±ä¸€åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼š

```typescript
// âœ… æ”¹é€²å‰ï¼šç¡¬ç·¨ç¢¼é è¨­å€¼
return template
  .replace('{excerpt}', defaultExcerpt)
  .replace('{backgroundUrl}', 'https://www.blocktempo.com/sample-background-article/') // ç¡¬ç·¨ç¢¼
  .replace('{backgroundTitle}', 'ç¯„ä¾‹èƒŒæ™¯æ–‡ç« æ¨™é¡Œ') // ç¡¬ç·¨ç¢¼
  .replace('{contextUrl}', 'https://www.blocktempo.com/sample-context-article/') // ç¡¬ç·¨ç¢¼
  .replace('{contextTitle}', 'ç¯„ä¾‹å‰æƒ…æ–‡ç« æ¨™é¡Œ'); // ç¡¬ç·¨ç¢¼

// âœ… æ”¹é€²å¾Œï¼šä½¿ç”¨çµ±ä¸€é…ç½®
const defaults = ArticleTemplates.sponsored.defaultRelatedArticles;
return template
  .replace('{excerpt}', defaultExcerpt)
  .replace('{contextUrl}', defaults.contextUrl)
  .replace('{contextTitle}', defaults.contextTitle)
  .replace('{backgroundUrl}', defaults.backgroundUrl)
  .replace('{backgroundTitle}', defaults.backgroundTitle);
```

**æ–°å¢é…ç½®çµæ§‹**ï¼š
```typescript
// ArticleTemplate ä»‹é¢æ–°å¢
defaultRelatedArticles?: {
  contextUrl: string;          // å‰æƒ…æè¦é€£çµ
  contextTitle: string;        // å‰æƒ…æè¦æ¨™é¡Œ
  backgroundUrl: string;       // èƒŒæ™¯è£œå……é€£çµ
  backgroundTitle: string;     // èƒŒæ™¯è£œå……æ¨™é¡Œ
};

defaultRelatedReading?: Array<{
  url: string;                 // ç›¸é—œé–±è®€é€£çµ
  title: string;               // ç›¸é—œé–±è®€æ¨™é¡Œ
}>;
```

**å­¸ç¿’åˆ°çš„æ•™è¨“**ï¼š
1. **DRY åŸå‰‡å¾ˆé‡è¦**ï¼šDon't Repeat Yourselfï¼Œé¿å…åœ¨å¤šå€‹åœ°æ–¹å®šç¾©ç›¸åŒçš„å…§å®¹
2. **çµ±ä¸€é…ç½®ç®¡ç†**ï¼šæ‡‰è©²æœ‰å–®ä¸€çš„é…ç½®æ–‡ä»¶ä½œç‚ºçœŸå¯¦ä¾†æº
3. **é‡æ§‹è¦è¬¹æ…**ï¼šç¢ºä¿åŠŸèƒ½ä¸éºå¤±ï¼Œä¸¦åŒæ­¥æ‰€æœ‰è‡ªè¨‚ä¿®æ”¹
4. **æ¶æ§‹è¨­è¨ˆè¦å‰ç»**ï¼šåˆæœŸè¨­è¨ˆæ™‚å°±æ‡‰è©²è€ƒæ…®é…ç½®çš„çµ±ä¸€ç®¡ç†
5. **ä»£ç¢¼å¯©æŸ¥çš„é‡è¦æ€§**ï¼šå®šæœŸå¯©æŸ¥æ˜¯å¦æœ‰é‡è¤‡å®šç¾©çš„å•é¡Œ
6. **é è¨­å€¼ä¹Ÿéœ€è¦çµ±ä¸€ç®¡ç†**ï¼šä¸åªæ˜¯æ¨¡æ¿ï¼Œé€£é è¨­å€¼ä¹Ÿæ‡‰è©²åœ¨é…ç½®æ–‡ä»¶ä¸­ç®¡ç†

**é˜²éŒ¯æª¢æŸ¥æ¸…å–®**ï¼š
â–¡ æ–°å¢æ¨¡æ¿æ™‚æª¢æŸ¥æ˜¯å¦å·²æœ‰ç›¸åŒå®šç¾©
â–¡ ä¿®æ”¹æ¨¡æ¿æ™‚ç¢ºèªåªæœ‰ä¸€å€‹ä¾†æº
â–¡ å®šæœŸå¯©æŸ¥ä»£ç¢¼ä¸­çš„é‡è¤‡å®šç¾©
â–¡ ä½¿ç”¨çµ±ä¸€çš„é…ç½®æ–‡ä»¶ç®¡ç†æ¨¡æ¿
â–¡ é‡æ§‹æ™‚ä¿æŒåŠŸèƒ½å®Œæ•´æ€§
â–¡ åŒæ­¥æ‰€æœ‰è‡ªè¨‚ä¿®æ”¹åˆ°çµ±ä¸€é…ç½®ä¸­
â–¡ é è¨­å€¼æ‡‰è©²åœ¨é…ç½®æ–‡ä»¶ä¸­å®šç¾©ï¼Œè€Œéç¡¬ç·¨ç¢¼
â–¡ ä¿®æ”¹é è¨­å€¼æ™‚åªéœ€è¦åœ¨ä¸€å€‹åœ°æ–¹ä¿®æ”¹

## 10. Article Formatting éšæ®µç•¶å‰åŠŸèƒ½ç¸½çµ

### 10.1 å·²å¯¦ç¾çš„æ ¸å¿ƒåŠŸèƒ½

åŸºæ–¼åƒæ•¸é©…å‹•çš„è¨­è¨ˆï¼Œ`ArticleFormattingProcessor` ç›®å‰æä¾›ä»¥ä¸‹6å€‹ä¸»è¦è½‰æ›åŠŸèƒ½ï¼š

#### 1. æ¨™é¡Œå±¤ç´šæ­£è¦åŒ– âœ…
- **åŠŸèƒ½**ï¼šèª¿æ•´HTMLæ¨™é¡Œå±¤ç´šï¼Œå¾ h2â†’h3, h3â†’h4, h4â†’h5
- **ç‰¹é»**ï¼šä¿æŒ h1 ä¸»æ¨™é¡Œä¸è®Šï¼Œç¢ºä¿æ¨™é¡Œå±¤ç´šçµæ§‹åˆç†
- **æŠ€è¡“è¦é»**ï¼šæ¡ç”¨å¾é«˜å±¤ç´šå¾€ä½å±¤ç´šçš„æ›¿æ›é †åºï¼Œé¿å…é€£é–æ›¿æ›å•é¡Œ

#### 2. å¼•è¨€å€å¡Šæ§‹å»º âœ…  
- **åŠŸèƒ½**ï¼šè‡ªå‹•æ’å…¥ intro_quote æ¨£å¼çš„å¼•è¨€å€å¡Š
- **å…§å®¹åŒ…å«**ï¼š
  - AIæ‘˜è¦å¼•è¨€ï¼ˆä¾†è‡ªcopy-editingéšæ®µæˆ–é è¨­æ–‡å­—ï¼‰
  - å‰æƒ…æè¦é€£çµï¼ˆç›®å‰ä½¿ç”¨é è¨­ç¯„ä¾‹ï¼‰
  - èƒŒæ™¯è£œå……é€£çµï¼ˆç›®å‰ä½¿ç”¨é è¨­ç¯„ä¾‹ï¼‰
- **HTMLæ ¼å¼**ï¼š`<p class="intro_quote">...</p>`

#### 3. é–‹é ­æŠ¼è¨»è™•ç† âœ…
- **åŠŸèƒ½**ï¼šæ ¹æ“š `headerDisclaimer` åƒæ•¸æ’å…¥å°æ‡‰çš„é–‹é ­è²æ˜
- **æ”¯æ´é¡å‹**ï¼š
  - `sponsored`: å»£ç·¨ç¨¿æŠ¼è¨»ï¼ˆå«æŠ•è³‡å»ºè­°è­¦ç¤ºï¼‰
  - `press-release`: æ–°èç¨¿æŠ¼è¨»ï¼ˆç°¡åŒ–ç‰ˆæœ¬ï¼‰
  - `none`: ä¸æ’å…¥æŠ¼è¨»
- **ç‰¹é»**ï¼šæ”¯æ´å‹•æ…‹æ›¿æ›æ’°ç¨¿æ–¹åç¨±

#### 4. Dropcapæ ¼å¼æ‡‰ç”¨ âœ…
- **åŠŸèƒ½**ï¼šç‚ºæ–‡ç« ç¬¬ä¸€æ®µçš„ç¬¬ä¸€å€‹å­—ç¬¦æ‡‰ç”¨ Dropcap æ¨£å¼
- **æ¨£å¼**ï¼šç™½åº•é»‘å­—çš„æ”¾å¤§é¦–å­—æ¯æ•ˆæœ
- **æŠ€è¡“**ï¼šæ™ºèƒ½è­˜åˆ¥ä¸­æ–‡å­—ç¬¦å’Œè‹±æ–‡å­—æ¯

#### 5. çµå°¾æŠ¼è¨»è™•ç† âœ…
- **åŠŸèƒ½**ï¼šæ ¹æ“š `footerDisclaimer` åƒæ•¸æ’å…¥çµå°¾å…è²¬è²æ˜
- **æ”¯æ´é¡å‹**ï¼š
  - `sponsored`: å®Œæ•´çš„å»£ç·¨ç¨¿å…è²¬è²æ˜
  - `press-release`: ç„¡çµå°¾æŠ¼è¨»
  - `none`: ä¸æ’å…¥æŠ¼è¨»
- **æ ¼å¼**ï¼šä½¿ç”¨ `alert alert-warning` æ¨£å¼

#### 6. TG Bannerå’Œç›¸é—œé–±è®€ âœ…
- **åŠŸèƒ½**ï¼šåœ¨æ–‡ç« æœ«å°¾è‡ªå‹•æ·»åŠ å›ºå®šå…ƒç´ 
- **åŒ…å«å…§å®¹**ï¼š
  - å‹•å€å®˜æ–¹ Telegram æ©«å¹…åœ–ç‰‡
  - ç›¸é—œé–±è®€æ¨™é¡Œï¼ˆğŸ“ç›¸é—œå ±å°ğŸ“ï¼‰
  - 2-3ç¯‡ç›¸é—œæ–‡ç« é€£çµï¼ˆç›®å‰ä½¿ç”¨é è¨­ç¯„ä¾‹ï¼‰
- **é€£çµæ ¼å¼**ï¼šç´…è‰²ç²—é«”æ¨£å¼

### 10.2 åƒæ•¸é©…å‹•çš„éˆæ´»æ€§

ç³»çµ±çš„æ ¸å¿ƒå„ªå‹¢åœ¨æ–¼åƒæ•¸é©…å‹•çš„è¨­è¨ˆï¼Œç”¨æˆ¶å¯ä»¥ï¼š

```typescript
// ç¯„ä¾‹ï¼šè‡ªè¨‚å»£ç·¨ç¨¿ï¼ˆåªè¦é–‹é ­æŠ¼è¨»ï¼‰
const customSettings: AdvancedArticleSettings = {
  headerDisclaimer: 'sponsored',    // å»£ç·¨ç¨¿é–‹é ­æŠ¼è¨»
  footerDisclaimer: 'none',         // ä¸è¦çµå°¾æŠ¼è¨»
  authorName: 'ABCç§‘æŠ€å…¬å¸'         // ä¾›ç¨¿æ–¹åç¨±
};

// ç¯„ä¾‹ï¼šæ··åˆæ¨¡å¼ï¼ˆå»£ç·¨ç¨¿ç”¨æ–°èç¨¿æŠ¼è¨»ï¼‰
const hybridSettings: AdvancedArticleSettings = {
  headerDisclaimer: 'press-release', // ä½¿ç”¨æ–°èç¨¿æŠ¼è¨»
  footerDisclaimer: 'none',          // ä¸è¦çµå°¾æŠ¼è¨»
  authorName: 'XYZå…¬å¸'              // ä¾›ç¨¿æ–¹åç¨±
};
```

### 10.3 å¾…å®Œå–„åŠŸèƒ½

ä»¥ä¸‹åŠŸèƒ½å·²è¦åŠƒä½†å°šæœªå¯¦ç¾ï¼Œç›®å‰ä½¿ç”¨é è¨­å…§å®¹ï¼š

1. **æ™ºèƒ½é—œè¯æ–‡ç« æœå°‹** - ç›®å‰ä½¿ç”¨é è¨­é€£çµï¼Œæœªä¾†éœ€æ•´åˆ BlockTempo æœå°‹API
2. **æ’°ç¨¿æ–¹åç¨±è‡ªå‹•è­˜åˆ¥** - ç›®å‰éœ€æ‰‹å‹•è¼¸å…¥ï¼Œæœªä¾†å¯ç”±AIå¾å…§å®¹ä¸­æå–
3. **æ–‡ç« é€£çµéæ¿¾é‚è¼¯** - ç›®å‰ä½¿ç”¨é è¨­é€£çµï¼Œæœªä¾†éœ€å¯¦ç¾TG/LINEé€£çµéæ¿¾
4. **å‹•æ…‹å…§å®¹é•·åº¦é©é…** - ç›®å‰å›ºå®šæ ¼å¼ï¼Œæœªä¾†å¯æ ¹æ“šæ–‡ç« é•·åº¦èª¿æ•´

### 10.4 æŠ€è¡“æ¶æ§‹å„ªå‹¢

1. **åƒæ•¸é©…å‹• vs é¡å‹é©…å‹•**ï¼šåŸºæ–¼å…·é«”è¨­å®šè€Œéæ–‡ç¨¿é¡å‹ï¼Œæä¾›æ›´å¤§éˆæ´»æ€§
2. **æ¨¡æ¿åŒ–è™•ç†**ï¼šåš´æ ¼æ ¼å¼ä½¿ç”¨æ¨¡æ¿ï¼Œç¢ºä¿ä¸€è‡´æ€§å’Œå¯ç¶­è­·æ€§
3. **éŒ¯èª¤å®¹å¿æ€§**ï¼šå³ä½¿è™•ç†å¤±æ•—ä¹Ÿæœƒè¿”å›åŸå§‹å…§å®¹ï¼Œç¢ºä¿ç³»çµ±ç©©å®šæ€§
4. **æ“´å±•æ€§è¨­è¨ˆ**ï¼šæ–°çš„æŠ¼è¨»é¡å‹æˆ–æ ¼å¼å¯è¼•é¬†æ·»åŠ åˆ°æ¨¡æ¿åº«
5. **å–®ä¸€çœŸå¯¦ä¾†æº**ï¼šçµ±ä¸€çš„æ¨¡æ¿é…ç½®ç®¡ç†ï¼Œé¿å…é‡è¤‡å®šç¾©å•é¡Œ
6. **è·è²¬åˆ†é›¢æ˜ç¢º**ï¼šAIéšæ®µè² è²¬æ™ºèƒ½åˆ†æï¼Œæ ¼å¼åŒ–éšæ®µè² è²¬æ¨¡æ¿æ‡‰ç”¨
7. **å…±ç”¨æ¨¡æ¿çµ±ä¸€ç®¡ç†**ï¼šé€é `CommonTemplates` å¯¦ç¾DRYåŸå‰‡ï¼Œä¸€è™•ä¿®æ”¹å…¨åŸŸç”Ÿæ•ˆ
8. **é…ç½®æ¶æ§‹æ¸…ç†**ï¼šç§»é™¤ä¸æ‡‰åœ¨æ ¼å¼åŒ–éšæ®µè™•ç†çš„AIåŠŸèƒ½é…ç½®ï¼Œæ¶æ§‹æ›´æ¸…æ™°
9. **Unicodeç·¨ç¢¼å®‰å…¨**ï¼šæ­£ç¢ºè™•ç†ä¸­æ–‡å­—ç¬¦å’Œç‰¹æ®Šå­—ç¬¦ï¼Œé¿å…ç·¨ç¢¼éŒ¯èª¤
10. **åœ‹éš›åŒ–å‹å¥½**ï¼šæ”¯æ´å¤šèªè¨€æ–‡ä»¶åå’Œå…§å®¹è™•ç†

### 10.5 æ¶æ§‹æ¸…ç†æˆæœ

#### ç§»é™¤çš„AIéšæ®µé…ç½®
ç¶“éæ¶æ§‹æ¸…ç†ï¼Œä»¥ä¸‹é…ç½®å·²å¾ Article Formatting ç§»é™¤ä¸¦æ­¸å±¬åˆ° AI éšæ®µï¼š
- **ä¸­æ–‡ç”¨èªè½‰æ›** (`terminologyMap`) - 40+ è½‰æ›è¦å‰‡
- **å…§å®¹éæ¿¾æ¨¡å¼** (`excludePatterns`) - EMBARGOEDç­‰æ•˜è¿°éæ¿¾  
- **é€£çµéæ¿¾é‚è¼¯** (`linkFiltering`) - TG/LINEé€£çµè™•ç†
- **åœ–ç‰‡è™•ç†è¦å‰‡** (`imageProcessing`) - å£“ç¸®ã€æ ¼å¼è½‰æ›ç­‰
- **æ¨™é¡Œå±¤ç´šé…ç½®** (`headingHierarchy`) - å¯¦éš›æœªä½¿ç”¨çš„é…ç½®

#### çµ±ä¸€çš„å…±ç”¨æ¨¡æ¿ç®¡ç†
é€é `CommonTemplates` å°è±¡çµ±ä¸€ç®¡ç†æ‰€æœ‰é¡å‹ç›¸åŒçš„æ¨¡æ¿ï¼š
- **11å€‹å…±ç”¨æ¨¡æ¿**ï¼šdropcapStyle, introQuoteTemplate, tgBannerç­‰
- **ä¸€è™•ä¿®æ”¹å…¨åŸŸç”Ÿæ•ˆ**ï¼šä¿®æ”¹å¼•è¨€æ¨¡æ¿æ™‚ä¸‰ç¨®æ–‡ç¨¿é¡å‹åŒæ­¥æ›´æ–°
- **ç‰¹æ®ŠåŒ–æ”¯æ´**ï¼šå»£ç·¨ç¨¿å¯è¦†è“‹å…±ç”¨æ¨¡æ¿ï¼ˆå¦‚ç´…è‰²é€£çµæ¨£å¼ï¼‰
- **ç¶­è­·ç°¡åŒ–**ï¼šæ¸›å°‘60+è¡Œé‡è¤‡ä»£ç¢¼

#### æ¸…æ™°çš„è·è²¬é‚Šç•Œ
```typescript
// âœ… ç¾åœ¨çš„æ¸…æ™°åˆ†å·¥
AI Agent (copy-editing): {
  æ™ºèƒ½å…§å®¹åˆ†æ,
  ä¸­æ–‡ç”¨èªè½‰æ›,
  é€£çµéæ¿¾,
  åœ–ç‰‡è™•ç†,
  æ’°ç¨¿æ–¹è­˜åˆ¥,
  é—œè¯æ–‡ç« æœå°‹
}

Article Formatting: {
  åƒæ•¸é©…å‹•çš„æ¨¡æ¿æ‡‰ç”¨,
  æŠ¼è¨»æ’å…¥,
  Dropcapæ¨£å¼,
  å¼•è¨€å€å¡Šæ§‹å»º,
  TG Banneræ·»åŠ ,
  æ¨™é¡Œå±¤ç´šæ­£è¦åŒ–
}
```

### 9.9 æ¶æ§‹æ¸…ç†ï¼šç§»é™¤æ‡‰åœ¨AIéšæ®µè™•ç†çš„é…ç½®
**å•é¡Œæè¿°**ï¼š`article-templates.ts` ä¸­åŒ…å«äº†è¨±å¤šæ‡‰è©²åœ¨å‰é¢AIéšæ®µè™•ç†çš„é…ç½®é …ï¼Œé€ æˆè·è²¬æ··æ·†å’Œæ¶æ§‹ä¸æ¸…æ™°ã€‚

**ç§»é™¤çš„é…ç½®é …**ï¼š
1. **`terminologyMap`** - ä¸­æ–‡ç”¨èªè½‰æ›è¦å‰‡ï¼ˆç¶²çµ¡â†’ç¶²è·¯ç­‰ï¼‰
2. **`excludePatterns`** - å…§å®¹æ’é™¤æ¨¡å¼ï¼ˆEMBARGOEDæ•˜è¿°éæ¿¾ç­‰ï¼‰
3. **`linkFiltering`** - é€£çµéæ¿¾è¦å‰‡ï¼ˆTG/LINEé€£çµåˆªé™¤ç­‰ï¼‰
4. **`imageProcessing`** - åœ–ç‰‡è™•ç†è¦å‰‡ï¼ˆå£“ç¸®ã€æ ¼å¼è½‰æ›ç­‰ï¼‰
5. **`headingHierarchy`** - æ¨™é¡Œå±¤ç´šè¦å‰‡ï¼ˆå¯¦éš›æœªä½¿ç”¨ï¼Œç¡¬ç·¨ç¢¼è™•ç†ï¼‰
6. **æ•´å€‹ `ContentProcessingRules` é…ç½®å°è±¡**
7. **`ContentProcessingConfig` TypeScript æ¥å£å®šç¾©**

**ç§»é™¤åŸå› åˆ†æ**ï¼š
```typescript
// âŒ éŒ¯èª¤çš„è·è²¬åˆ†é…
Article Formatting: {
  æ¨¡æ¿æ ¼å¼æ‡‰ç”¨ + ä¸­æ–‡è½‰æ› + é€£çµéæ¿¾ + åœ–ç‰‡è™•ç† + å…§å®¹éæ¿¾...
}

// âœ… æ­£ç¢ºçš„è·è²¬åˆ†é…  
AI Agent (copy-editing): {
  æ™ºèƒ½å…§å®¹åˆ†æ + ä¸­æ–‡è½‰æ› + é€£çµéæ¿¾ + åœ–ç‰‡è™•ç† + å…§å®¹éæ¿¾
}
Article Formatting: {
  ç´”ç²¹çš„æ¨¡æ¿æ‡‰ç”¨ + æ ¼å¼åŒ–
}
```

**å…·é«”ç§»é™¤å…§å®¹**ï¼š
```typescript
// âŒ å·²ç§»é™¤ï¼šä¸æ‡‰åœ¨æ ¼å¼åŒ–éšæ®µè™•ç†
export const ContentProcessingRules = {
  terminologyMap: {
    'ç¶²çµ¡': 'ç¶²è·¯',
    'ä¿¡æ¯': 'è³‡è¨Š',
    // ... 40+ è½‰æ›è¦å‰‡
  },
  excludePatterns: [
    /EMBARGOED[\s\S]*?GMT\+8\)/gi,
    // ... æ›´å¤šéæ¿¾æ¨¡å¼
  ],
  // ... å…¶ä»–AIéšæ®µåŠŸèƒ½
};
```

**æ¶æ§‹æ¸…ç†æ•ˆæœ**ï¼š
- **ä»£ç¢¼è¡Œæ•¸æ¸›å°‘**ï¼šç§»é™¤60+è¡Œç„¡ç”¨é…ç½®
- **è·è²¬é‚Šç•Œæ¸…æ™°**ï¼šAIéšæ®µè² è²¬æ™ºèƒ½åˆ†æï¼Œæ ¼å¼åŒ–éšæ®µè² è²¬æ¨¡æ¿æ‡‰ç”¨
- **é…ç½®ç®¡ç†ç°¡åŒ–**ï¼šæ¸›å°‘æ··æ·†ï¼Œæé«˜ç¶­è­·æ€§
- **åŠŸèƒ½æ­¸å±¬æ­£ç¢º**ï¼šæ™ºèƒ½åŠŸèƒ½æ­¸å±¬AIï¼Œæ ¼å¼åŠŸèƒ½æ­¸å±¬æ ¼å¼åŒ–

### 9.10 DropcapéŒ¯èª¤æ‡‰ç”¨åˆ°å¼•è¨€å€å¡Šä¿®å¾©
**å•é¡Œæè¿°**ï¼šç”¨æˆ¶å°å¼•è¨€æ¨¡æ¿é€²è¡Œæ ¼å¼èª¿æ•´å¾Œï¼ŒDropcapåŠŸèƒ½éŒ¯èª¤åœ°æ‡‰ç”¨åˆ°äº†å‰è¨€å€å¡Šçš„ç¬¬ä¸€å€‹å­—ï¼Œè€Œä¸æ˜¯æ­£æ–‡å…§å®¹çš„ç¬¬ä¸€å€‹å­—ã€‚

**æ ¹æœ¬åŸå› åˆ†æ**ï¼š
åœ¨ `applyDropcap` æ–¹æ³•ä¸­ï¼ŒåŸå§‹é‚è¼¯ä½¿ç”¨ç°¡å–®çš„æŸ¥æ‰¾ä¾†å®šä½ç¬¬ä¸€å€‹æ®µè½ï¼š
```typescript
// âŒ éŒ¯èª¤çš„æŸ¥æ‰¾é‚è¼¯
const firstParagraphMatch = content.match(/<p[^>]*>(.*?)<\/p>/i);
```

**å•é¡Œæˆå› **ï¼š
1. å¼•è¨€å€å¡Šè¢«æ’å…¥åˆ°å…§å®¹çš„æœ€å‰é¢ï¼ˆæ­£ç¢ºçš„é‚è¼¯ï¼‰
2. `applyDropcap` æ‰¾åˆ°çš„ç¬¬ä¸€å€‹ `<p>` æ¨™ç±¤æ˜¯å¼•è¨€å€å¡Šï¼ˆ`<p class="intro_quote">`ï¼‰
3. Dropcap è¢«éŒ¯èª¤åœ°æ‡‰ç”¨åˆ°å¼•è¨€æ–‡å­—ï¼Œè€Œä¸æ˜¯æ­£æ–‡

**é æœŸè™•ç†é †åº**ï¼š
1. å¼•è¨€å€å¡Šï¼ˆä¸æ‡‰æ‡‰ç”¨ Dropcapï¼‰
2. é–‹é ­æŠ¼è¨»
3. **æ­£æ–‡ç¬¬ä¸€æ®µ**ï¼ˆâœ… æ‡‰è©²æ‡‰ç”¨ Dropcap çš„ä½ç½®ï¼‰
4. å…¶ä»–æ­£æ–‡å…§å®¹

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
ä¿®æ”¹ `applyDropcap` æ–¹æ³•ï¼Œå¯¦ç¾æ™ºèƒ½æ®µè½è­˜åˆ¥ï¼š
```typescript
// âœ… æ­£ç¢ºçš„æŸ¥æ‰¾é‚è¼¯
const paragraphMatches = content.match(/<p[^>]*>.*?<\/p>/gi);

// éæ­·æ‰€æœ‰æ®µè½ï¼Œè·³éå¼•è¨€å€å¡Š
let targetParagraph = null;
for (let i = 0; i < paragraphMatches.length; i++) {
  const paragraph = paragraphMatches[i];
  // è·³éå¼•è¨€å€å¡Šï¼ˆclass="intro_quote"ï¼‰
  if (!paragraph.includes('class="intro_quote"')) {
    targetParagraph = paragraph;
    break;
  }
}
```

**ä¿®å¾©æ•ˆæœ**ï¼š
- **æ™ºèƒ½æ®µè½è­˜åˆ¥**ï¼šè‡ªå‹•è·³éå¼•è¨€å€å¡Š
- **ç²¾ç¢ºå®šä½**ï¼šæ‰¾åˆ°çœŸæ­£çš„æ­£æ–‡ç¬¬ä¸€æ®µ
- **å‘å‰å…¼å®¹**ï¼šæ²’æœ‰å¼•è¨€å€å¡Šæ™‚ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ
- **éŒ¯èª¤å®¹å¿**ï¼šæ‰¾ä¸åˆ°åˆé©æ®µè½æ™‚å®‰å…¨è¿”å›åŸå§‹å…§å®¹

### 9.11 Unicodeå­—ç¬¦ç·¨ç¢¼å•é¡Œä¿®å¾©
**å•é¡Œæè¿°**ï¼šç”¨æˆ¶åœ¨ä¸Šå‚³åŒ…å«ä¸­æ–‡å­—ç¬¦çš„åœ–ç‰‡æ™‚é‡åˆ°éŒ¯èª¤ï¼š`Cannot convert argument to a ByteString because the character at index 22 has a value of 21205 which is greater than 255`

**éŒ¯èª¤åˆ†æ**ï¼š
- **éŒ¯èª¤ä½ç½®**ï¼š`uploadMediaFromUrl` å‡½æ•¸ä¸­çš„ `useSimplifiedWPIntegration.tsx:92`
- **æ ¹æœ¬åŸå› **ï¼šè™•ç†åŒ…å«Unicodeå­—ç¬¦ï¼ˆå¦‚ä¸­æ–‡ï¼‰çš„åœ–ç‰‡URLæ™‚ï¼Œå­—ç¬¦ç·¨ç¢¼è™•ç†ä¸ç•¶
- **æŠ€è¡“ç´°ç¯€**ï¼šå­—ç¬¦21205æ˜¯ä¸­æ–‡å­—ç¬¦çš„Unicodeç¢¼é»ï¼Œè¶…å‡ºByteStringçš„0-255ç¯„åœ

**å•é¡Œæˆå› **ï¼š
1. **æ–‡ä»¶åæå–**ï¼šå¾URLæå–çš„æ–‡ä»¶ååŒ…å«ä¸­æ–‡å­—ç¬¦
2. **HTTPé ­è¨­ç½®**ï¼š`Content-Disposition` é ­ä¸­çš„Unicodeå­—ç¬¦æ²’æœ‰æ­£ç¢ºç·¨ç¢¼
3. **èªè­‰å­—ç¬¦ä¸²**ï¼š`Buffer.from()` è™•ç†åŒ…å«Unicodeçš„èªè­‰ä¿¡æ¯æ™‚å‡ºéŒ¯

**è§£æ±ºæ–¹æ¡ˆ1ï¼šå®‰å…¨æ–‡ä»¶åè™•ç†**
```typescript
// âœ… ä¿®å¾©æ–‡ä»¶åUnicodeå­—ç¬¦å•é¡Œ
let safeFilename = filename;
try {
  // ç§»é™¤éASCIIå­—ç¬¦ï¼Œé¿å…ByteStringè½‰æ›éŒ¯èª¤
  safeFilename = filename.replace(/[^\x00-\x7F]/g, '');
  
  // å¦‚æœæ–‡ä»¶åå¤ªçŸ­ï¼Œç”Ÿæˆå®‰å…¨çš„æ›¿ä»£æ–‡ä»¶å
  if (safeFilename.length < 3) {
    const timestamp = Date.now();
    const extension = filename.includes('.') ? filename.split('.').pop() : 'jpg';
    safeFilename = `image-${timestamp}.${extension}`;
  }
  
  // ç¢ºä¿åªåŒ…å«å®‰å…¨å­—ç¬¦
  safeFilename = safeFilename.replace(/[^a-zA-Z0-9.\-_]/g, '-');
} catch (filenameError) {
  safeFilename = `image-${Date.now()}.jpg`;
}
```

**è§£æ±ºæ–¹æ¡ˆ2ï¼šå®‰å…¨èªè­‰å­—ç¬¦ä¸²è™•ç†**
```typescript
// âœ… ä¿®å¾©èªè­‰å­—ç¬¦ä¸²Unicodeç·¨ç¢¼å•é¡Œ
let base64Auth;
try {
  // ä½¿ç”¨TextEncoderç¢ºä¿æ­£ç¢ºçš„UTF-8ç·¨ç¢¼
  const encoder = new TextEncoder();
  const authBytes = encoder.encode(authString);
  base64Auth = Buffer.from(authBytes).toString('base64');
} catch (authError) {
  // å›é€€æ–¹æ¡ˆ
  base64Auth = Buffer.from(authString, 'utf8').toString('base64');
}
```

**ä¿®å¾©æ•ˆæœ**ï¼š
- **å­—ç¬¦ç·¨ç¢¼å®‰å…¨**ï¼šæ­£ç¢ºè™•ç†Unicodeå­—ç¬¦ï¼Œé¿å…ByteStringè½‰æ›éŒ¯èª¤
- **æ–‡ä»¶åæ¨™æº–åŒ–**ï¼šå°‡åŒ…å«ä¸­æ–‡çš„æ–‡ä»¶åè½‰æ›ç‚ºå®‰å…¨çš„ASCIIæ–‡ä»¶å
- **éŒ¯èª¤å®¹å¿**ï¼šæä¾›å›é€€æ–¹æ¡ˆï¼Œç¢ºä¿åœ¨ç•°å¸¸æƒ…æ³ä¸‹ä¹Ÿèƒ½ç¹¼çºŒå·¥ä½œ
- **å‘å‰å…¼å®¹**ï¼šä¸å½±éŸ¿ç¾æœ‰çš„ASCIIæ–‡ä»¶åè™•ç†

**å­¸ç¿’åˆ°çš„æ•™è¨“**ï¼š
1. **åœ‹éš›åŒ–è¦ææ—©è€ƒæ…®**ï¼šè™•ç†æ–‡ä»¶ä¸Šå‚³æ™‚è¦è€ƒæ…®Unicodeå­—ç¬¦çš„æƒ…æ³
2. **å­—ç¬¦ç·¨ç¢¼è¦æ˜ç¢º**ï¼šåœ¨ä¸åŒç’°å¢ƒé–“å‚³éæ•¸æ“šæ™‚ï¼Œè¦æ˜ç¢ºç·¨ç¢¼æ ¼å¼
3. **éŒ¯èª¤è™•ç†è¦å®Œå–„**ï¼šæä¾›å›é€€æ–¹æ¡ˆï¼Œé¿å…å–®ä¸€å¤±æ•—å°è‡´æ•´å€‹æµç¨‹ä¸­æ–·
4. **æ¸¬è©¦è¦åŒ…å«é‚Šç•Œæƒ…æ³**ï¼šè¦æ¸¬è©¦åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æƒ…æ³

**é˜²éŒ¯æª¢æŸ¥æ¸…å–®**ï¼š
â–¡ è™•ç†URLå’Œæ–‡ä»¶åæ™‚è€ƒæ…®Unicodeå­—ç¬¦
â–¡ HTTPé ­è¨­ç½®æ™‚ä½¿ç”¨å®‰å…¨çš„å­—ç¬¦ç·¨ç¢¼
â–¡ æä¾›å­—ç¬¦ç·¨ç¢¼å¤±æ•—æ™‚çš„å›é€€æ–¹æ¡ˆ
â–¡ æ¸¬è©¦åŒ…å«ä¸­æ–‡å­—ç¬¦çš„æ–‡ä»¶åå’ŒURL
â–¡ ç¢ºä¿ `Buffer.from()` æ­£ç¢ºè™•ç†UTF-8ç·¨ç¢¼
â–¡ è¨˜éŒ„æ–‡ä»¶åè½‰æ›éç¨‹ï¼Œä¾¿æ–¼èª¿è©¦

### 9.12 AIæ‘˜è¦æ•¸æ“šå‚³éå•é¡Œä¿®å¾©
**å•é¡Œæè¿°**ï¼šç”¨æˆ¶ç™¼ç¾å¼•è¨€éƒ¨åˆ†é¡¯ç¤ºçš„æ˜¯é è¨­å…§å®¹ã€ŒAI æ‘˜è¦å¼•è¨€ï¼Œç°¡è¿°æœ¬ç¯‡æ–‡ç« é‡é»å…§å®¹ã€‚ã€ï¼Œè€Œä¸æ˜¯ Copy Editing éšæ®µ AI ç”Ÿæˆçš„çœŸå¯¦æ‘˜è¦ã€‚

**æ ¹æœ¬åŸå› åˆ†æ**ï¼š
1. **æ•¸æ“šçµæ§‹ä¸åŒ¹é…**ï¼šArticle Formatting æœŸæœ› `EnhancedCopyEditingResult.content_analysis.excerpt`ï¼Œä½† Copy Editing å¯¦éš›è¿”å› `CopyEditResult.wordpressParams.excerpt`
2. **éŒ¯èª¤çš„æ•¸æ“šå‚³é**ï¼šåœ¨ `useArticleFormattingStage.tsx` ä¸­ï¼Œ`analysisResult` è¢«è¨­ç½®ç‚º `copyEditingResult.wordpressParams`ï¼Œè€Œä¸æ˜¯å®Œæ•´çš„åˆ†æçµæœ
3. **æ•¸æ“šæµç¨‹ç¼ºå¤±**ï¼šCopy Editing ç”Ÿæˆçš„ AI æ‘˜è¦å­˜åœ¨æ–¼ `wordpressParams.excerpt`ï¼Œä½†æ²’æœ‰æ­£ç¢ºå‚³éåˆ° Article Formatting

**æ•¸æ“šæµç¨‹åˆ†æ**ï¼š
```typescript
// âŒ éŒ¯èª¤çš„æ•¸æ“šæµç¨‹
Copy Editing â†’ wordpressParams.excerpt (AIç”Ÿæˆçš„æ‘˜è¦)
       â†“
Article Formatting â† analysisResult: wordpressParams (éŒ¯èª¤çµæ§‹)
       â†“
buildIntroQuote(analysisResult?.content_analysis?.excerpt) â†’ undefined
       â†“
ä½¿ç”¨é è¨­æ–‡å­—ï¼šã€ŒAI æ‘˜è¦å¼•è¨€ï¼Œç°¡è¿°æœ¬ç¯‡æ–‡ç« é‡é»å…§å®¹ã€‚ã€

// âœ… ä¿®å¾©å¾Œçš„æ•¸æ“šæµç¨‹
Copy Editing â†’ wordpressParams.excerpt (AIç”Ÿæˆçš„æ‘˜è¦)
       â†“
Article Formatting â† analysisResult: { content_analysis: { excerpt: wordpressParams.excerpt } }
       â†“
buildIntroQuote(analysisResult?.content_analysis?.excerpt) â†’ AIç”Ÿæˆçš„æ‘˜è¦
       â†“
é¡¯ç¤ºçœŸå¯¦çš„AIæ‘˜è¦å…§å®¹
```

**è§£æ±ºæ–¹æ¡ˆ1ï¼šä¿®å¾©æ•¸æ“šå‚³éçµæ§‹**
åœ¨ `useArticleFormattingStage.tsx` ä¸­é‡æ§‹ `analysisResult` æ•¸æ“šï¼š
```typescript
// âœ… ä¿®å¾©ï¼šæ§‹å»ºæ­£ç¢ºçš„æ•¸æ“šçµæ§‹
analysisResult: {
  wordpress_params: copyEditingResult.wordpressParams,
  content_analysis: {
    excerpt: copyEditingResult.wordpressParams.excerpt || '', // ğŸ”§ é—œéµä¿®å¾©
    author_name: copyEditingResult.wordpressParams.author ? String(copyEditingResult.wordpressParams.author) : undefined,
    chinese_terminology_fixes: [],
    suggested_slug: copyEditingResult.wordpressParams.slug || '',
    estimated_reading_time: undefined
  },
  related_articles: {
    background: [],
    previous_context: [],
    related_reading: []
  },
  article_classification: articleClassification
}
```

**è§£æ±ºæ–¹æ¡ˆ2ï¼šæ”¹é€²æ‘˜è¦è™•ç†é‚è¼¯**
åœ¨ `ArticleFormattingProcessor.ts` ä¸­å¢å¼· `buildIntroQuote` æ–¹æ³•ï¼š
```typescript
// âœ… æ”¹é€²æ‘˜è¦è™•ç†é‚è¼¯
let finalExcerpt = excerpt;

// å¦‚æœæ²’æœ‰AIç”Ÿæˆçš„æ‘˜è¦ï¼Œæˆ–æ‘˜è¦ç‚ºç©º/ç„¡æ„ç¾©
if (!finalExcerpt || finalExcerpt.trim() === '' || finalExcerpt.includes('æ­¤æ–‡ç« æœªç¶“éåƒæ•¸ç”Ÿæˆè™•ç†')) {
  finalExcerpt = 'AI æ‘˜è¦å¼•è¨€ï¼Œç°¡è¿°æœ¬ç¯‡æ–‡ç« é‡é»å…§å®¹ã€‚';
  console.warn('ä½¿ç”¨é è¨­æ‘˜è¦ï¼ŒåŸå› ï¼š', !excerpt ? 'æœªæä¾›æ‘˜è¦' : 'æ‘˜è¦ç„¡æ•ˆ');
} else {
  console.log('ä½¿ç”¨AIç”Ÿæˆçš„æ‘˜è¦:', finalExcerpt.substring(0, 100) + (finalExcerpt.length > 100 ? '...' : ''));
}
```

**ä¿®å¾©æ•ˆæœ**ï¼š
- **AIæ‘˜è¦æ­£ç¢ºé¡¯ç¤º**ï¼šå¼•è¨€å€å¡Šç¾åœ¨æœƒé¡¯ç¤º Copy Editing éšæ®µç”Ÿæˆçš„çœŸå¯¦ AI æ‘˜è¦
- **æ•¸æ“šçµæ§‹çµ±ä¸€**ï¼šä¿®å¾©äº† Copy Editing å’Œ Article Formatting é–“çš„æ•¸æ“šçµæ§‹ä¸åŒ¹é…å•é¡Œ
- **èª¿è©¦ä¿¡æ¯å®Œå–„**ï¼šæ·»åŠ äº†è©³ç´°çš„æ—¥èªŒè¼¸å‡ºï¼Œä¾¿æ–¼è¿½è¹¤æ‘˜è¦ä¾†æº
- **é™ç´šè™•ç†å®Œå–„**ï¼šç•¶ AI æ‘˜è¦ç„¡æ•ˆæ™‚ï¼Œæœƒè¨˜éŒ„åŸå› ä¸¦ä½¿ç”¨é è¨­æ–‡å­—

**å­¸ç¿’åˆ°çš„æ•™è¨“**ï¼š
1. **æ•¸æ“šçµæ§‹ä¸€è‡´æ€§å¾ˆé‡è¦**ï¼šä¸åŒéšæ®µé–“çš„æ•¸æ“šå‚³éå¿…é ˆç¢ºä¿çµæ§‹åŒ¹é…
2. **è¦æª¢æŸ¥å®Œæ•´çš„æ•¸æ“šæµç¨‹**ï¼šå¾æ•¸æ“šç”Ÿæˆåˆ°æœ€çµ‚ä½¿ç”¨çš„æ¯å€‹ç’°ç¯€éƒ½è¦é©—è­‰
3. **èª¿è©¦ä¿¡æ¯è¦å®Œå–„**ï¼šæ·»åŠ è©³ç´°çš„æ—¥èªŒè¼¸å‡ºæœ‰åŠ©æ–¼å¿«é€Ÿå®šä½å•é¡Œ
4. **è¦æœ‰æ˜ç¢ºçš„æ•¸æ“šå¥‘ç´„**ï¼šå®šç¾©æ¸…æ¥šå„éšæ®µé–“å‚³éçš„æ•¸æ“šçµæ§‹

**é˜²éŒ¯æª¢æŸ¥æ¸…å–®**ï¼š
â–¡ ç¢ºèªå„éšæ®µé–“çš„æ•¸æ“šçµæ§‹åŒ¹é…
â–¡ é©—è­‰æ•¸æ“šå¾ç”Ÿæˆåˆ°ä½¿ç”¨çš„å®Œæ•´æµç¨‹
â–¡ æ·»åŠ è©³ç´°çš„èª¿è©¦æ—¥èªŒè¼¸å‡º
â–¡ æ¸¬è©¦æœ‰ç„¡AIæ‘˜è¦çš„å…©ç¨®æƒ…æ³
â–¡ ç¢ºä¿é™ç´šè™•ç†é‚è¼¯æ­£ç¢º
â–¡ å®šæœŸæª¢æŸ¥æ•¸æ“šå¥‘ç´„çš„ä¸€è‡´æ€§

### 9.13 æ–‡ç¨¿åˆ†é¡ç«¶æ…‹æ¢ä»¶å•é¡Œä¿®å¾©
**å•é¡Œæè¿°**ï¼šé€²éšæ ¼å¼åŒ–éšæ®µå‡ºç¾éŒ¯èª¤ "ç¼ºå°‘æ–‡ç¨¿åˆ†é¡ä¿¡æ¯ï¼Œè«‹ç¢ºä¿å·²æ­£ç¢ºè¨­ç½®æ–‡ç¨¿é¡å‹"ï¼Œå°è‡´è™•ç†æµç¨‹ä¸­æ–·ã€‚

**æ ¹æœ¬åŸå› åˆ†æ**ï¼š
é€™æ˜¯ä¸€å€‹**ç«¶æ…‹æ¢ä»¶ï¼ˆRace Conditionï¼‰**å•é¡Œï¼Œç™¼ç”Ÿåœ¨é‡æ–°è™•ç†æ–‡ä»¶æ™‚ï¼š

1. **é‡ç½®é‚è¼¯æœ‰å»¶é²**ï¼šåœ¨ `IntegratedFileProcessor.handleProcess` ä¸­ï¼Œç•¶é‡æ–°è™•ç†æ™‚æœƒå…ˆèª¿ç”¨ `resetProcessState()`
2. **ç•°æ­¥è¨­ç½®æ–‡ç¨¿åˆ†é¡**ï¼šåŸå§‹ä»£ç¢¼ä½¿ç”¨ `setTimeout(() => { setArticleClassification(classification); }, 0)` ä¾†è¨­ç½®æ–‡ç¨¿åˆ†é¡
3. **é€²éšæ ¼å¼åŒ–éšæ®µæ¶è·‘**ï¼šç”±æ–¼ JavaScript çš„ç•°æ­¥ç‰¹æ€§ï¼Œé€²éšæ ¼å¼åŒ–éšæ®µå¯èƒ½åœ¨æ–‡ç¨¿åˆ†é¡é‡æ–°è¨­ç½®ä¹‹å‰å°±é–‹å§‹åŸ·è¡Œ
4. **`getArticleClassification()` è¿”å› undefined**ï¼šå°è‡´é€²éšæ ¼å¼åŒ–éšæ®µç²å–ä¸åˆ°æ–‡ç¨¿åˆ†é¡ä¿¡æ¯

**æ™‚åºå•é¡Œåˆ†æ**ï¼š
```typescript
// âŒ å•é¡Œçš„æ™‚åº
1. ç”¨æˆ¶é»æ“Šé‡æ–°è™•ç†
2. resetProcessState() â†’ processState = null
3. setTimeout(() => setArticleClassification(...), 0) â†’ å»¶é²åŸ·è¡Œ
4. è™•ç†æµç¨‹é–‹å§‹ â†’ å„éšæ®µé–‹å§‹åŸ·è¡Œ
5. é€²éšæ ¼å¼åŒ–éšæ®µåŸ·è¡Œ â†’ getArticleClassification() è¿”å› undefined âŒ
6. æ‹‹å‡ºéŒ¯èª¤ï¼š"ç¼ºå°‘æ–‡ç¨¿åˆ†é¡ä¿¡æ¯"
7. setTimeout å›èª¿åŸ·è¡Œ â†’ æ–‡ç¨¿åˆ†é¡è¨­ç½®å®Œæˆï¼ˆä½†å·²ç¶“å¤ªæ™šäº†ï¼‰

// âœ… ä¿®å¾©å¾Œçš„æ™‚åº
1. ç”¨æˆ¶é»æ“Šé‡æ–°è™•ç†
2. resetProcessState() â†’ processState = null
3. setArticleClassification(classification) â†’ ç«‹å³åŸ·è¡Œï¼Œå‰µå»ºè‡¨æ™‚ç‹€æ…‹ âœ…
4. è™•ç†æµç¨‹é–‹å§‹ â†’ å„éšæ®µé–‹å§‹åŸ·è¡Œ
5. é€²éšæ ¼å¼åŒ–éšæ®µåŸ·è¡Œ â†’ getArticleClassification() è¿”å›æ­£ç¢ºçš„åˆ†é¡ä¿¡æ¯ âœ…
6. è™•ç†æˆåŠŸå®Œæˆ
```

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
ç§»é™¤ `setTimeout` å»¶é²ï¼Œæ”¹ç‚ºç«‹å³è¨­ç½®æ–‡ç¨¿åˆ†é¡ï¼š

```typescript
// âŒ ä¿®å¾©å‰ï¼šç•°æ­¥è¨­ç½®ï¼Œå­˜åœ¨ç«¶æ…‹æ¢ä»¶
if (processSuccess) {
  // ... é‡ç½®é‚è¼¯
  resetProcessState();
  
  // é‡ç½®å¾Œç«‹å³é‡æ–°è¨­ç½®æ–‡ç¨¿åˆ†é¡ï¼Œç¢ºä¿è³‡æ–™ä¸ä¸Ÿå¤±
  setTimeout(() => {
    setArticleClassification(classification);
    console.log('é‡ç½®å¾Œé‡æ–°è¨­ç½®æ–‡ç¨¿åˆ†é¡:', classification);
  }, 0);
}

// âœ… ä¿®å¾©å¾Œï¼šåŒæ­¥è¨­ç½®ï¼Œé¿å…ç«¶æ…‹æ¢ä»¶
if (processSuccess) {
  // ... é‡ç½®é‚è¼¯
  resetProcessState();
  
  // ğŸ”§ ä¿®å¾©ç«¶æ…‹æ¢ä»¶ï¼šç«‹å³é‡æ–°è¨­ç½®æ–‡ç¨¿åˆ†é¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ setTimeout
  // ç¢ºä¿åœ¨é‡ç½®å¾Œæ–‡ç¨¿åˆ†é¡ç«‹å³å¯ç”¨ï¼Œé¿å…é€²éšæ ¼å¼åŒ–éšæ®µæ‰¾ä¸åˆ°åˆ†é¡ä¿¡æ¯
  setArticleClassification(classification);
  console.log('é‡ç½®å¾Œç«‹å³é‡æ–°è¨­ç½®æ–‡ç¨¿åˆ†é¡:', classification);
}
```

**ä¿®å¾©æ•ˆæœ**ï¼š
- **æ¶ˆé™¤ç«¶æ…‹æ¢ä»¶**ï¼šæ–‡ç¨¿åˆ†é¡åœ¨é‡ç½®å¾Œç«‹å³å¯ç”¨ï¼Œä¸å­˜åœ¨æ™‚åºå•é¡Œ
- **ç©©å®šçš„è™•ç†æµç¨‹**ï¼šé€²éšæ ¼å¼åŒ–éšæ®µèƒ½ç©©å®šç²å–åˆ°æ–‡ç¨¿åˆ†é¡ä¿¡æ¯
- **éŒ¯èª¤è™•ç†æ”¹å–„**ï¼šé¿å…å› æ–‡ç¨¿åˆ†é¡ç¼ºå¤±å°è‡´çš„è™•ç†ä¸­æ–·
- **æ•¸æ“šä¸€è‡´æ€§**ï¼šç¢ºä¿è™•ç†æµç¨‹ä¸­çš„æ•¸æ“šç‹€æ…‹ä¸€è‡´æ€§

**ProcessingContext çš„ä¿è­·æ©Ÿåˆ¶**ï¼š
`setArticleClassification` æ–¹æ³•å·²ç¶“æœ‰è™•ç† `processState` ç‚º null çš„ä¿è­·æ©Ÿåˆ¶ï¼š
```typescript
const setArticleClassification = useCallback((classification: ArticleClassification) => {
  setProcessState(prevState => {
    if (!prevState) {
      // å¦‚æœ processState ç‚º nullï¼Œå‰µå»ºä¸€å€‹è‡¨æ™‚ç‹€æ…‹ä¾†å­˜å„²æ–‡ç¨¿åˆ†é¡
      const tempState: ProcessState = {
        ...JSON.parse(JSON.stringify(initialState)),
        id: `temp-${Date.now()}`,
        article_classification: classification
      };
      return tempState;
    }
    return {
      ...prevState,
      article_classification: classification
    };
  });
}, []);
```

**å­¸ç¿’åˆ°çš„æ•™è¨“**ï¼š
1. **é¿å…ä¸å¿…è¦çš„ç•°æ­¥æ“ä½œ**ï¼šåœ¨ç‹€æ…‹ç®¡ç†ä¸­ï¼Œèƒ½åŒæ­¥åŸ·è¡Œçš„æ“ä½œå°±ä¸è¦ä½¿ç”¨ç•°æ­¥
2. **ç«¶æ…‹æ¢ä»¶å¾ˆé›£èª¿è©¦**ï¼šæ™‚åºå•é¡Œå¾€å¾€ä¸å®¹æ˜“é‡ç¾ï¼Œéœ€è¦ä»”ç´°åˆ†æä»£ç¢¼åŸ·è¡Œé †åº
3. **ç‹€æ…‹é‡ç½®è¦è¬¹æ…**ï¼šé‡ç½®ç‹€æ…‹å¾Œçš„é‡æ–°åˆå§‹åŒ–é‚è¼¯è¦ç¢ºä¿ç«‹å³åŸ·è¡Œ
4. **ä¿è­·æ©Ÿåˆ¶è¦å®Œå–„**ï¼šé—œéµçš„ç‹€æ…‹ç²å–æ–¹æ³•è¦æœ‰å®¹éŒ¯è™•ç†

**é˜²éŒ¯æª¢æŸ¥æ¸…å–®**ï¼š
â–¡ é¿å…åœ¨ç‹€æ…‹ç®¡ç†ä¸­ä½¿ç”¨ä¸å¿…è¦çš„ setTimeout
â–¡ ç¢ºä¿ç‹€æ…‹é‡ç½®å¾Œçš„é‡æ–°åˆå§‹åŒ–é‚è¼¯ç«‹å³åŸ·è¡Œ
â–¡ æª¢æŸ¥æ˜¯å¦å­˜åœ¨å…¶ä»–ç«¶æ…‹æ¢ä»¶é¢¨éšª
â–¡ æ¸¬è©¦é‡æ–°è™•ç†æ–‡ä»¶çš„å ´æ™¯
â–¡ ç¢ºä¿é—œéµç‹€æ…‹çš„ç²å–æ–¹æ³•æœ‰å®¹éŒ¯è™•ç†
â–¡ æ·»åŠ è©³ç´°çš„æ—¥èªŒè¼¸å‡ºå¹«åŠ©èª¿è©¦æ™‚åºå•é¡Œ

### 9.14 Dropcap æ•¸å­—å­—ç¬¦è™•ç†å•é¡Œä¿®å¾©
**å•é¡Œæè¿°**ï¼šç”¨æˆ¶åæ˜ åœ¨é€²éšæ ¼å¼åŒ–è™•ç†å¾Œï¼Œæ–‡ç« é–‹é ­çš„ "2025 å¹´" è®Šæˆäº†åªå‰©ä¸‹ "å¹´"ï¼Œ"2025 " éƒ¨åˆ†è¢«éŒ¯èª¤åœ°ç§»é™¤äº†ã€‚

**æ ¹æœ¬åŸå› åˆ†æ**ï¼š
åœ¨ `ArticleFormattingProcessor.applyDropcap` æ–¹æ³•ä¸­å­˜åœ¨å…©å€‹å•é¡Œï¼š

1. **æ­£å‰‡è¡¨é”å¼ä¸æ”¯æ´æ•¸å­—**ï¼š
   ```typescript
   // âŒ åŸå§‹æ­£å‰‡è¡¨é”å¼ä¸åŒ…å«æ•¸å­—
   const firstCharMatch = paragraphContent.match(/^[^<]*?([a-zA-Z\u4e00-\u9fa5])/);
   ```
   å°æ–¼ "2025 å¹´" é€™æ¨£çš„å…§å®¹ï¼Œæ­£å‰‡è¡¨é”å¼æœƒè·³éæ•¸å­— "2025 "ï¼Œç›´æ¥åŒ¹é…åˆ° "å¹´"

2. **å‰©é¤˜å…§å®¹è¨ˆç®—éŒ¯èª¤**ï¼š
   ```typescript
   // âŒ ä½¿ç”¨ indexOf æœƒåœ¨æœ‰é‡è¤‡å­—ç¬¦æ™‚å®šä½éŒ¯èª¤
   const remainingContent = paragraphContent.substring(paragraphContent.indexOf(firstChar) + 1);
   ```
   ç•¶ `firstChar` ç‚º "å¹´" æ™‚ï¼Œæœƒå¾ "å¹´" ä¹‹å¾Œé–‹å§‹å–å‰©é¤˜å…§å®¹ï¼Œå°è‡´ "2025 " è¢«ä¸Ÿæ£„

**éŒ¯èª¤è™•ç†æµç¨‹**ï¼š
```
åŸå§‹å…§å®¹: "2025 å¹´å¤å­£ä¸Šç·šï¼Œå…§å®¹..."
â†“
æ­£å‰‡åŒ¹é…: /^[^<]*?([a-zA-Z\u4e00-\u9fa5])/ â†’ åŒ¹é…åˆ° "å¹´"
â†“
firstChar = "å¹´"
â†“
indexOf("å¹´") â†’ æ‰¾åˆ° "å¹´" çš„ä½ç½®
â†“
remainingContent = å¾ "å¹´" ä¹‹å¾Œçš„å…§å®¹ â†’ " å¤å­£ä¸Šç·šï¼Œå…§å®¹..."
â†“
çµæœ: <span class="dropcap">å¹´</span> å¤å­£ä¸Šç·šï¼Œå…§å®¹...
âŒ "2025 " è¢«ä¸Ÿæ£„äº†ï¼
```

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
1. **æ“´å±•æ­£å‰‡è¡¨é”å¼æ”¯æ´æ•¸å­—**ï¼š
   ```typescript
   // âœ… æ“´å±•æ­£å‰‡è¡¨é”å¼åŒ…å«æ•¸å­— 0-9
   const firstCharMatch = paragraphContent.match(/^[^<]*?([0-9a-zA-Z\u4e00-\u9fa5])/);
   ```

2. **æ”¹é€²å‰©é¤˜å…§å®¹è¨ˆç®—é‚è¼¯**ï¼š
   ```typescript
   // âœ… ä½¿ç”¨ search æ–¹æ³•æ‰¾åˆ°ç¬¬ä¸€å€‹å­—ç¬¦çš„ç¢ºåˆ‡ä½ç½®
   const firstCharIndex = paragraphContent.search(/[0-9a-zA-Z\u4e00-\u9fa5]/);
   const remainingContent = paragraphContent.substring(firstCharIndex + 1);
   ```

**ä¿®å¾©å¾Œçš„è™•ç†æµç¨‹**ï¼š
```
åŸå§‹å…§å®¹: "2025 å¹´å¤å­£ä¸Šç·šï¼Œå…§å®¹..."
â†“
æ­£å‰‡åŒ¹é…: /^[^<]*?([0-9a-zA-Z\u4e00-\u9fa5])/ â†’ åŒ¹é…åˆ° "2"
â†“
firstChar = "2"
â†“
search(/[0-9a-zA-Z\u4e00-\u9fa5]/) â†’ æ‰¾åˆ°ç¬¬ä¸€å€‹å­—ç¬¦ "2" çš„ä½ç½® (0)
â†“
remainingContent = å¾ä½ç½® 1 é–‹å§‹çš„å…§å®¹ â†’ "025 å¹´å¤å­£ä¸Šç·šï¼Œå…§å®¹..."
â†“
çµæœ: <span class="dropcap">2</span>025 å¹´å¤å­£ä¸Šç·šï¼Œå…§å®¹...
âœ… å®Œæ•´ä¿ç•™æ‰€æœ‰å…§å®¹ï¼
```

**ä¿®å¾©ä»£ç¢¼å°æ¯”**ï¼š
```typescript
// âŒ ä¿®å¾©å‰ï¼šä¸æ”¯æ´æ•¸å­—ï¼Œè¨ˆç®—éŒ¯èª¤
const firstCharMatch = paragraphContent.match(/^[^<]*?([a-zA-Z\u4e00-\u9fa5])/);
const firstChar = firstCharMatch[1];
const remainingContent = paragraphContent.substring(paragraphContent.indexOf(firstChar) + 1);

// âœ… ä¿®å¾©å¾Œï¼šæ”¯æ´æ•¸å­—ï¼Œç²¾ç¢ºè¨ˆç®—
const firstCharMatch = paragraphContent.match(/^[^<]*?([0-9a-zA-Z\u4e00-\u9fa5])/);
const firstChar = firstCharMatch[1];
const firstCharIndex = paragraphContent.search(/[0-9a-zA-Z\u4e00-\u9fa5]/);
const remainingContent = paragraphContent.substring(firstCharIndex + 1);
```

**æ”¯æ´çš„å­—ç¬¦é¡å‹æ“´å±•**ï¼š
- **æ•¸å­—**: `0-9` (æ–°å¢æ”¯æ´)
- **è‹±æ–‡å­—æ¯**: `a-z`, `A-Z` (åŸæœ‰æ”¯æ´)
- **ä¸­æ–‡å­—ç¬¦**: `\u4e00-\u9fa5` (åŸæœ‰æ”¯æ´)

**ä¿®å¾©æ•ˆæœ**ï¼š
- âœ… **æ­£ç¢ºè™•ç†æ•¸å­—é–‹é ­**ï¼šå¦‚ "2025 å¹´"ã€"1.5 è¬"ã€"100% å®Œæˆ" ç­‰
- âœ… **ç²¾ç¢ºå­—ç¬¦å®šä½**ï¼šé¿å…é‡è¤‡å­—ç¬¦å°è‡´çš„ä½ç½®éŒ¯èª¤
- âœ… **å…§å®¹å®Œæ•´ä¿ç•™**ï¼šç¢ºä¿æ²’æœ‰å­—ç¬¦è¢«æ„å¤–ä¸Ÿæ£„
- âœ… **å‘å‰å…¼å®¹**ï¼šä¸å½±éŸ¿åŸæœ‰çš„è‹±æ–‡å’Œä¸­æ–‡å­—ç¬¦è™•ç†

**æ·»åŠ èª¿è©¦ä¿¡æ¯**ï¼š
```typescript
console.log('Dropcap è™•ç†è©³æƒ…:', {
  originalContent: paragraphContent.substring(0, 50) + '...',
  firstChar: firstChar,
  firstCharIndex: firstCharIndex,
  remainingContent: remainingContent.substring(0, 50) + '...'
});
```

**å­¸ç¿’åˆ°çš„æ•™è¨“**ï¼š
1. **æ­£å‰‡è¡¨é”å¼è¦è€ƒæ…®å®Œæ•´**ï¼šè¨­è¨ˆå­—ç¬¦åŒ¹é…æ™‚è¦è€ƒæ…®æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦é¡å‹
2. **å­—ç¬¦ä¸²æ“ä½œè¦ç²¾ç¢º**ï¼šä½¿ç”¨ `search()` æ¯” `indexOf()` æ›´é©åˆæ­£å‰‡è¡¨é”å¼å®šä½
3. **é‚Šç•Œæ¢ä»¶è¦æ¸¬è©¦**ï¼šéœ€è¦æ¸¬è©¦æ•¸å­—ã€è‹±æ–‡ã€ä¸­æ–‡ç­‰å„ç¨®é–‹é ­çš„å…§å®¹
4. **èª¿è©¦ä¿¡æ¯å¾ˆé‡è¦**ï¼šæ·»åŠ è©³ç´°æ—¥èªŒæœ‰åŠ©æ–¼å¿«é€Ÿå®šä½å•é¡Œ

**é˜²éŒ¯æª¢æŸ¥æ¸…å–®**ï¼š
â–¡ æ­£å‰‡è¡¨é”å¼åŒ…å«æ‰€æœ‰éœ€è¦çš„å­—ç¬¦é¡å‹ï¼ˆæ•¸å­—ã€è‹±æ–‡ã€ä¸­æ–‡ï¼‰
â–¡ å­—ç¬¦ä¸²ä½ç½®è¨ˆç®—ä½¿ç”¨ç²¾ç¢ºçš„æ–¹æ³•
â–¡ æ¸¬è©¦å„ç¨®å­—ç¬¦é–‹é ­çš„å…§å®¹ï¼ˆæ•¸å­—ã€è‹±æ–‡ã€ä¸­æ–‡ï¼‰
â–¡ æ·»åŠ èª¿è©¦æ—¥èªŒå¹«åŠ©å•é¡Œå®šä½
â–¡ ç¢ºä¿å‰©é¤˜å…§å®¹è¨ˆç®—çš„æº–ç¢ºæ€§
â–¡ é©—è­‰ Dropcap è™•ç†ä¸æœƒä¸Ÿå¤±ä»»ä½•å­—ç¬¦

### 9.15 Dropcap æ™ºèƒ½å­—ç¬¦è™•ç†æ”¹é€²ï¼ˆæ–¹æ¡ˆAå¯¦æ–½ï¼‰
**å•é¡Œæè¿°**ï¼šç”¨æˆ¶ç™¼ç¾åŸå§‹DropcapåŠŸèƒ½æœƒä¸Ÿå¤±æœ‰æ„ç¾©çš„ç¬¦è™Ÿï¼Œå¦‚ \"$ETH\" è®Šæˆ \"ETH\"ï¼Œ\"ã€Œå¼•ç”¨ã€\" è®Šæˆ \"å¼•ç”¨ã€\"ã€‚

**æ ¹æœ¬åŸå› é‡æ–°åˆ†æ**ï¼š
åŸå§‹è¨­è¨ˆä½¿ç”¨é™åˆ¶æ€§æ­£å‰‡è¡¨é”å¼ `/^[^<]*?([0-9a-zA-Z\\u4e00-\\u9fa5])/` æ˜¯åŸºæ–¼ä»¥ä¸‹æ“”å¿ƒï¼š

1. **HTMLæ¨™ç±¤æ±¡æŸ“**ï¼šæ“”å¿ƒ `<span>å…§å®¹` æœƒè®Šæˆ `<span class=\"dropcap\"><</span>span>å…§å®¹`
2. **ç©ºç™½å­—ç¬¦å•é¡Œ**ï¼šæ“”å¿ƒç©ºæ ¼ä½œç‚ºDropcapä¸ç¾è§€
3. **è¦–è¦ºæ•ˆæœè€ƒé‡**ï¼šèªç‚ºæŸäº›ç¬¦è™Ÿä¸é©åˆä½œç‚ºDropcap

ä½†é€™å°è‡´äº†åš´é‡çš„åŠŸèƒ½ç¼ºé™·ï¼Œä¸Ÿå¤±é‡è¦çš„å…§å®¹ç¬¦è™Ÿã€‚

**æ–¹æ¡ˆAï¼šæ™ºèƒ½å­—ç¬¦æƒæç®—æ³•**

**æŠ€è¡“å¯¦ç¾**ï¼š
```typescript
// âœ… æ–°çš„æ™ºèƒ½æƒæç®—æ³•
let searchIndex = 0;
let firstChar = '';
let firstCharOriginalIndex = -1;

while (searchIndex < paragraphContent.length) {
  const char = paragraphContent[searchIndex];
  
  // è·³éç©ºç™½å­—ç¬¦
  if (/\\s/.test(char)) {
    searchIndex++;\n    continue;\n  }\n  \n  // è·³éHTMLæ¨™ç±¤\n  if (char === '<') {\n    const tagEndIndex = paragraphContent.indexOf('>', searchIndex);\n    if (tagEndIndex !== -1) {\n      searchIndex = tagEndIndex + 1;\n      continue;\n    }\n  }\n  \n  // æ‰¾åˆ°ç¬¬ä¸€å€‹å¯¦éš›å­—ç¬¦\n  firstChar = char;\n  firstCharOriginalIndex = searchIndex;\n  break;\n}\n\n// åªæ’é™¤æ˜ç¢ºæœ‰å®³çš„å­—ç¬¦\nconst problematicChars = ['<', '>', '&', '\\n', '\\r', '\\t'];\nif (problematicChars.includes(firstChar)) {\n  return content; // è·³éè™•ç†\n}\n```

**ç®—æ³•å„ªå‹¢**ï¼š
1. **æ™ºèƒ½æƒæ**ï¼šé€å­—ç¬¦åˆ†æï¼Œç²¾ç¢ºè·³éHTMLå’Œç©ºç™½
2. **ç¬¦è™Ÿä¿ç•™**ï¼šä¿ç•™æ‰€æœ‰æœ‰æ„ç¾©çš„ç¬¦è™Ÿ
3. **HTMLå®‰å…¨**ï¼šæ­£ç¢ºè™•ç†åµŒå¥—HTMLæ¨™ç±¤
4. **æ€§èƒ½å„ªåŒ–**ï¼šç·šæ€§æƒæï¼Œæ•ˆç‡é«˜

**ä¿®å¾©æ•ˆæœå°æ¯”**ï¼š

| æ¸¬è©¦å…§å®¹ | ä¿®å¾©å‰ï¼ˆé™åˆ¶æ€§æ­£å‰‡ï¼‰ | ä¿®å¾©å¾Œï¼ˆæ™ºèƒ½æƒæï¼‰ | ç‹€æ…‹ |\n|---------|-------------------|-------------------|------|\n| `$ETH åƒ¹æ ¼ä¸Šæ¼²` | `<span class=\"dropcap\">E</span>TH åƒ¹æ ¼ä¸Šæ¼²` | `<span class=\"dropcap\">$</span>ETH åƒ¹æ ¼ä¸Šæ¼²` | âœ… ä¿®å¾© |\n| `ã€Œé€™æ˜¯å¼•ç”¨ã€` | `<span class=\"dropcap\">é€™</span>æ˜¯å¼•ç”¨ã€` | `<span class=\"dropcap\">ã€Œ</span>é€™æ˜¯å¼•ç”¨ã€` | âœ… ä¿®å¾© |\n| `@username ç™¼å¸ƒ` | `<span class=\"dropcap\">u</span>sername ç™¼å¸ƒ` | `<span class=\"dropcap\">@</span>username ç™¼å¸ƒ` | âœ… ä¿®å¾© |\n| `#hashtag å…§å®¹` | `<span class=\"dropcap\">h</span>ashtag å…§å®¹` | `<span class=\"dropcap\">#</span>hashtag å…§å®¹` | âœ… ä¿®å¾© |\n| `2025 å¹´å¤å­£` | `<span class=\"dropcap\">å¹´</span>å¤å­£` | `<span class=\"dropcap\">2</span>025 å¹´å¤å­£` | âœ… ä¿®å¾© |\n| `<strong>é‡è¦</strong>` | æ­£å¸¸è™•ç† | æ­£å¸¸è™•ç† | âœ… ä¿æŒ |\n| `  ç©ºç™½é–‹é ­` | è·³éç©ºç™½ | è·³éç©ºç™½ | âœ… ä¿æŒ |\n\n**æ ¸å¿ƒæ”¹é€²é»**ï¼š\n1. **å¾é™åˆ¶æ€§è®Šç‚ºåŒ…å®¹æ€§**ï¼šä¸å†é™åˆ¶å­—ç¬¦é¡å‹ï¼Œè€Œæ˜¯åªæ’é™¤æœ‰å®³å­—ç¬¦\n2. **ç²¾ç¢ºçš„HTMLè™•ç†**ï¼šæ­£ç¢ºè·³éå®Œæ•´çš„HTMLæ¨™ç±¤çµæ§‹\n3. **ä½ç½®è¨ˆç®—æ”¹é€²**ï¼šä½¿ç”¨åŸå§‹ç´¢å¼•è€Œésearchæ–¹æ³•ï¼Œé¿å…é‡è¤‡å­—ç¬¦å•é¡Œ\n4. **è©³ç´°èª¿è©¦æ—¥èªŒ**ï¼šæä¾›å®Œæ•´çš„è™•ç†éç¨‹è¨˜éŒ„\n\n**æŠ€è¡“åƒ¹å€¼**ï¼š\n- **ç”¨æˆ¶é«”é©—æå‡**ï¼šä¿ç•™å®Œæ•´çš„å…§å®¹èªç¾©\n- **åŠŸèƒ½å®Œæ•´æ€§**ï¼šæ”¯æ´å„ç¨®ç¾ä»£å…§å®¹æ ¼å¼ï¼ˆåŠ å¯†è²¨å¹£ã€ç¤¾äº¤åª’é«”ã€æ¨™ç±¤ç­‰ï¼‰\n- **ç¶­è­·æ€§æ”¹å–„**ï¼šç®—æ³•é‚è¼¯æ¸…æ™°ï¼Œæ˜“æ–¼ç†è§£å’Œä¿®æ”¹\n- **æ“´å±•æ€§å¢å¼·**ï¼šå¯è¼•æ˜“èª¿æ•´problematicCharsåˆ—è¡¨ä»¥é©æ‡‰æ–°éœ€æ±‚