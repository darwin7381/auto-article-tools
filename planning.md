# 自動化媒體新聞處理與上稿系統規劃

## 1. 專案概述

本專案旨在打造一款專為媒體編輯部門設計的自動化工具，用於處理各種來源的新聞內容，並自動轉換、處理及發布到 WordPress 平台，大幅提升內容處理與發布效率，減少人工操作環節。系統採用一頁式設計，確保使用流程簡潔直觀。

範例用輸入文件，存放於 input-example 資料夾

## 2. 核心功能需求

### 2.1 文件輸入處理
- **支援格式**：PDF、DOCX 文件處理
- **連結輸入支援**：
  - Google Docs 文件連結
  - Medium 文章連結
  - WeChat 公眾號文章連結
  - 一般網站文章連結

### 2.2 內容處理
- **語言檢測**：自動識別文檔語言（繁體中文、簡體中文、英文等）
- **翻譯功能**：將非繁體中文內容自動翻譯為繁體中文（使用台灣用語）
- **格式保留**：保留原始文本格式，包括段落、標題、列表等
- **媒體處理**：提取和處理文件/連結中的圖片，上傳至 WordPress 媒體庫
- **超連結處理**：保留原文中的超連結，確保在發布的文章中正確顯示

### 2.3 智能內容增強
- **AI 摘要生成**：自動生成不超過 30 字的文章摘要
- **標準模板套用**：將內容格式化為指定的 HTML 模板（如前情提要、免責聲明等）
- **關聯內容推薦**：自動推薦相關報導連結

### 2.4 WordPress 整合
- **自動發布**：支援一鍵發布到 WordPress 平台
- **API 整合**：通過 WordPress API 進行內容管理
- **預覽功能**：發布前可預覽文章最終呈現效果

### 2.5 用戶身份驗證與權限
- **Google 登入集成**：使用 Clerk 快速整合 Google Auth
- **權限管理**：根據用戶角色分配不同的操作權限
- **工作流程控制**：基於用戶身份實現內容審核流程
- **安全訪問控制**：保護系統資源和 API 端點
- **登入狀態保持**：維持用戶會話並提供簡便的再次登入體驗

## 3. 技術架構

### 3.1 前端界面
- **技術選擇**：Next.js + HeroUI
  - **Next.js** 作為全棧框架，提供：
    - 內建 API Routes 簡化後端開發
    - 服務端渲染和靜態生成能力
    - 文件系統路由減少配置代碼
    - 與 Vercel 無縫集成的部署體驗
  - **HeroUI** 作為 UI 組件庫，提供：
    - 美觀現代的設計系統
    - 豐富的預製組件
    - 基於 Tailwind CSS 的高性能實現
    - 內建暗色模式支持
    - 完全可定制的主題
    - 優秀的可訪問性支持

- **UI 設計**：一頁式響應式設計，參考 wmriknxs.manus.space 的簡潔布局
- **實時狀態反饋**：處理進度條和步驟指示器
- **用戶體驗**：專注於簡潔流暢的操作流程

### 3.2 後端服務
- **技術選擇**：Next.js API Routes
- **API 設計**：RESTful API 設計
- **文件處理**：使用適當的庫處理 DOCX 和 PDF 文件
  - DOCX: `mammoth.js` 或 `docx4js`
  - PDF: `pdf-parse` 或 `pdf.js`
- **爬蟲服務**：
  - 整合 FireScrawl Tools 進行網頁爬取
  - FireScrawl 提供強大的內容抓取、轉換能力
  - 支持多種網站類型，包括需要渲染 JavaScript 的動態網站
  - 可配置爬取深度和範圍，適合不同類型的文章來源

### 3.3 AI 服務
- **OpenAI 整合**：
  - 使用 ChatGPT API 實現所有 AI 相關功能
  - 語言檢測與翻譯：使用同一 API 進行檢測和翻譯處理
  - 內容摘要：生成符合需求的簡短摘要
  - 相關內容推薦：基於文章內容分析推薦相關主題

### 3.4 儲存與快取
- **文件暫存**：
  - 使用 Cloudflare R2 作為文件存儲方案
  - 兼容 S3 API，但成本更低
  - 適合存儲上傳的文件和處理過的媒體資源
- **媒體存儲**：
  - 與 WordPress 媒體庫整合
  - 可選 Cloudflare CDN 加速媒體內容分發
- **處理結果快取**：
  - Redis 用於快取處理結果和臨時資料
  - 提高系統響應速度和性能

### 3.5 身份驗證與安全
- **Clerk 整合**：
  - 提供完整的身份驗證基礎設施
  - 無縫整合 Google Auth 登入
  - 內建多因素驗證和安全性功能
- **中間件保護**：
  - 保護 API 和前端路由
  - 基於角色的訪問控制
- **JWT 處理**：
  - 安全令牌管理
  - 會話保持和過期處理
- **用戶資料安全**：
  - 加密敏感信息
  - 符合數據保護標準

## 4. 用戶流程與界面

範例網站： https://wmriknxs.manus.space

### 4.1 一頁式界面布局
- **頂部區域**：系統標題與簡介
- **輸入區域**：文件上傳區域與連結輸入表單
- **進度顯示**：處理階段與進度條
- **預覽區域**：文章預覽與簡單編輯
- **發布區域**：WordPress 發布設置
- **底部區域**：功能說明與系統信息

### 4.2 用戶流程
1. **輸入選擇**：用戶選擇上傳文件或提交連結
2. **內容處理**：系統顯示處理進度和當前階段
3. **預覽確認**：用戶預覽處理後的內容並可進行簡單調整
4. **發布設置**：用戶配置 WordPress 發布參數
5. **提交發布**：系統發布內容並顯示結果

## 5. 開發階段規劃

### 5.1 階段一：Input 處理
- ✅ 實現文件上傳組件 (PDF、DOCX)
- ✅ 實現連結輸入組件
- ✅ 設計輸入驗證邏輯
- ✅ 完善一頁式基本布局

### 5.2 階段二：內容初步處理
- ✅  PDF/DOCX 文本提取
- ✅  圖片提取 & 上傳至 r2，回傳連結形成完整 Markdown 為檔案提取結果
- ✅  OpenAI 進行初步處理：語言偵測、基本翻譯、生成完整文章 Markdown
- 進度顯示功能
- 使用 FireScrawl 進行網頁內容爬取，實現輸入連結的 Input 方式

### 5.3 階段三：內容後期處理
- OpenAI 摘要生成，以作為前言
- 內容格式化與標準模板套用
- 相關內容推薦
- 預覽功能完善
- 初步集成 Clerk 身份驗證功能

### 5.4 階段四：上傳 WordPress
- WordPress API 集成
- 發布設置界面
- 媒體庫上傳功能
- 發布狀態追蹤
- 系統整體測試與優化
- 完善 Clerk 身份驗證與權限管理

## 6. 擴展性與未來規劃

### 6.1 支援更多內容來源
- 社交媒體平台內容（Twitter、LinkedIn 等）
- 視頻內容摘要與處理（YouTube 等）
- 訂閱源處理（RSS 等）

### 6.2 多平台發布支援
- 擴展至其他 CMS 平台（如 Drupal、Joomla 等）
- 社交媒體同步發布功能
- 多媒體內容分發網絡集成

### 6.3 團隊協作功能
- 編輯審核流程
- 用戶權限管理
- 內容版本控制

## 7. 技術挑戰和解決方案

### 7.1 多語言處理
- **挑戰**：準確檢測語言和高質量翻譯
- **解決方案**：使用 OpenAI API 處理語言檢測和翻譯，保證一致性和質量

### 7.2 內容格式保留
- **挑戰**：保留原始文檔的格式結構
- **解決方案**：使用專業文檔處理庫，結合自定義格式轉換規則

### 7.3 系統性能
- **挑戰**：處理大文件和大量圖片時的性能問題
- **解決方案**：實現任務隊列和異步處理，優化資源使用

### 7.4 網站爬蟲穩定性
- **挑戰**：各類網站結構不同，且可能經常更新
- **解決方案**：利用 FireScrawl Tools 的強大爬蟲能力，減少自定義爬蟲開發

### 7.5 身份驗證安全性
- **挑戰**：確保身份驗證系統安全可靠，防止未授權訪問
- **解決方案**：利用 Clerk 的專業身份驗證服務，實現安全的 Google Auth 整合

## 8. 系統需求與部署

### 8.1 硬件需求
- **客戶端**：基本的網絡連接和現代瀏覽器
- **服務端**：由 Vercel 和 Cloudflare 提供服務，無需管理實體硬件

### 8.2 軟件需求
- **前端**：Next.js + HeroUI
- **後端**：Next.js API Routes
- **存儲**：Cloudflare R2 用於文件存儲
- **身份驗證**：Clerk 服務集成 Google Auth

### 8.3 部署方案
- **前端與後端**：Vercel 平台統一部署，自動化 CI/CD
- **靜態資源**：Vercel Edge Network
- **文件存儲**：Cloudflare R2
- **監控**：Vercel Analytics + Sentry 錯誤追蹤 